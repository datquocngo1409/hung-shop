{"ast":null,"code":"import _inherits from \"/home/datquocngo/Project/Hung/gts-fe/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/datquocngo/Project/Hung/gts-fe/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _classCallCheck from \"/home/datquocngo/Project/Hung/gts-fe/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/datquocngo/Project/Hung/gts-fe/node_modules/@babel/runtime/helpers/esm/createClass\";\n\n/* eslint-disable no-multi-spaces, key-spacing, indent, camelcase, space-before-blocks, eqeqeq, brace-style */\n\n/* eslint-disable space-infix-ops, space-before-function-paren, array-bracket-spacing, object-curly-spacing */\n\n/* eslint-disable no-nested-ternary, max-params, default-case, no-else-return, no-empty */\n\n/* eslint-disable no-param-reassign, no-var, block-scoped-var */\nimport { BinaryStream, ucs2encode, base64ToUint8Array, HAS_TYPED_ARRAYS } from \"./utils\";\nimport { support } from '../common';\nimport { TTFFont } from \"./ttf\";\nimport { deflate, supportsDeflate } from './deflate';\nimport { encodeUTF16BE, BOM } from \"../util/encode-utf\";\nvar browser = support.browser;\nvar NL = \"\\n\";\nvar RESOURCE_COUNTER = 0;\nvar PAPER_SIZE = {\n  a0: [2383.94, 3370.39],\n  a1: [1683.78, 2383.94],\n  a2: [1190.55, 1683.78],\n  a3: [841.89, 1190.55],\n  a4: [595.28, 841.89],\n  a5: [419.53, 595.28],\n  a6: [297.64, 419.53],\n  a7: [209.76, 297.64],\n  a8: [147.40, 209.76],\n  a9: [104.88, 147.40],\n  a10: [73.70, 104.88],\n  b0: [2834.65, 4008.19],\n  b1: [2004.09, 2834.65],\n  b2: [1417.32, 2004.09],\n  b3: [1000.63, 1417.32],\n  b4: [708.66, 1000.63],\n  b5: [498.90, 708.66],\n  b6: [354.33, 498.90],\n  b7: [249.45, 354.33],\n  b8: [175.75, 249.45],\n  b9: [124.72, 175.75],\n  b10: [87.87, 124.72],\n  c0: [2599.37, 3676.54],\n  c1: [1836.85, 2599.37],\n  c2: [1298.27, 1836.85],\n  c3: [918.43, 1298.27],\n  c4: [649.13, 918.43],\n  c5: [459.21, 649.13],\n  c6: [323.15, 459.21],\n  c7: [229.61, 323.15],\n  c8: [161.57, 229.61],\n  c9: [113.39, 161.57],\n  c10: [79.37, 113.39],\n  executive: [521.86, 756.00],\n  folio: [612.00, 936.00],\n  legal: [612.00, 1008.00],\n  letter: [612.00, 792.00],\n  tabloid: [792.00, 1224.00]\n};\n\nfunction makeOutput() {\n  var indentLevel = 0,\n      output = BinaryStream();\n\n  function out() {\n    for (var i = 0; i < arguments.length; ++i) {\n      var x = arguments[i];\n\n      if (x === undefined) {\n        throw new Error(\"Cannot output undefined to PDF\");\n      } else if (x instanceof PDFValue) {\n        x.beforeRender(out);\n        x.render(out);\n      } else if (isArray(x)) {\n        renderArray(x, out);\n      } else if (isDate(x)) {\n        renderDate(x, out);\n      } else if (typeof x == \"number\") {\n        if (isNaN(x)) {\n          throw new Error(\"Cannot output NaN to PDF\");\n        } // make sure it doesn't end up in exponent notation\n\n\n        var num = x.toFixed(7);\n\n        if (num.indexOf(\".\") >= 0) {\n          num = num.replace(/\\.?0+$/, \"\");\n        }\n\n        if (num == \"-0\") {\n          num = \"0\";\n        }\n\n        output.writeString(num);\n      } else if (/string|boolean/.test(typeof x)) {\n        output.writeString(String(x));\n      } else if (typeof x.get == \"function\") {\n        output.write(x.get());\n      } else if (typeof x == \"object\") {\n        if (!x) {\n          output.writeString(\"null\");\n        } else {\n          out(new PDFDictionary(x));\n        }\n      }\n    }\n  }\n\n  out.writeData = function (data) {\n    output.write(data);\n  };\n\n  out.withIndent = function (f) {\n    ++indentLevel;\n    f(out);\n    --indentLevel;\n  };\n\n  out.indent = function () {\n    out(NL, pad(\"\", indentLevel * 2, \"  \"));\n    out.apply(null, arguments);\n  };\n\n  out.offset = function () {\n    return output.offset();\n  };\n\n  out.toString = function () {\n    throw new Error(\"FIX CALLER\");\n  };\n\n  out.get = function () {\n    return output.get();\n  };\n\n  out.stream = function () {\n    return output;\n  };\n\n  return out;\n}\n\nfunction wrapObject(value, id) {\n  var beforeRender = value.beforeRender;\n  var renderValue = value.render;\n\n  value.beforeRender = function () {};\n\n  value.render = function (out) {\n    out(id, \" 0 R\");\n  };\n\n  value.renderFull = function (out) {\n    value._offset = out.offset();\n    out(id, \" 0 obj \");\n    beforeRender.call(value, out);\n    renderValue.call(value, out);\n    out(\" endobj\");\n  };\n}\n\nfunction getPaperOptions(getOption) {\n  if (typeof getOption != \"function\") {\n    var options = getOption;\n\n    getOption = function getOption(key, def) {\n      return key in options ? options[key] : def;\n    };\n  }\n\n  var paperSize = getOption(\"paperSize\", PAPER_SIZE.a4);\n\n  if (!paperSize) {\n    return {};\n  }\n\n  if (typeof paperSize == \"string\") {\n    paperSize = PAPER_SIZE[paperSize.toLowerCase()];\n\n    if (paperSize == null) {\n      throw new Error(\"Unknown paper size\");\n    }\n  }\n\n  paperSize[0] = unitsToPoints(paperSize[0]);\n  paperSize[1] = unitsToPoints(paperSize[1]);\n\n  if (getOption(\"landscape\", false)) {\n    paperSize = [Math.max(paperSize[0], paperSize[1]), Math.min(paperSize[0], paperSize[1])];\n  }\n\n  var margin = getOption(\"margin\");\n\n  if (margin) {\n    if (typeof margin == \"string\" || typeof margin == \"number\") {\n      margin = unitsToPoints(margin, 0);\n      margin = {\n        left: margin,\n        top: margin,\n        right: margin,\n        bottom: margin\n      };\n    } else {\n      margin = {\n        left: unitsToPoints(margin.left, 0),\n        top: unitsToPoints(margin.top, 0),\n        right: unitsToPoints(margin.right, 0),\n        bottom: unitsToPoints(margin.bottom, 0)\n      };\n    }\n\n    if (getOption(\"addMargin\")) {\n      paperSize[0] += margin.left + margin.right;\n      paperSize[1] += margin.top + margin.bottom;\n    }\n  }\n\n  return {\n    paperSize: paperSize,\n    margin: margin\n  };\n}\n\nvar FONT_CACHE = {\n  \"Times-Roman\": true,\n  \"Times-Bold\": true,\n  \"Times-Italic\": true,\n  \"Times-BoldItalic\": true,\n  \"Helvetica\": true,\n  \"Helvetica-Bold\": true,\n  \"Helvetica-Oblique\": true,\n  \"Helvetica-BoldOblique\": true,\n  \"Courier\": true,\n  \"Courier-Bold\": true,\n  \"Courier-Oblique\": true,\n  \"Courier-BoldOblique\": true,\n  \"Symbol\": true,\n  \"ZapfDingbats\": true\n};\n\nfunction loadBinary(url, cont) {\n  // IE throws Accesss denied error for Data URIs\n  var m;\n\n  if (browser.msie && (m = /^data:.*?;base64,/i.exec(url))) {\n    cont(base64ToUint8Array(url.substr(m[0].length)));\n    return;\n  }\n\n  function error() {\n    if (window.console) {\n      if (window.console.error) {\n        window.console.error(\"Cannot load URL: %s\", url);\n      } else {\n        window.console.log(\"Cannot load URL: %s\", url);\n      }\n    }\n\n    cont(null);\n  }\n\n  var req = new XMLHttpRequest();\n  req.open('GET', url, true);\n\n  if (HAS_TYPED_ARRAYS) {\n    req.responseType = \"arraybuffer\";\n  }\n\n  req.onload = function () {\n    if (req.status == 200 || req.status == 304) {\n      if (HAS_TYPED_ARRAYS) {\n        cont(new Uint8Array(req.response));\n      } else {\n        cont(new window.VBArray(req.responseBody).toArray()); // IE9 only\n      }\n    } else {\n      error();\n    }\n  };\n\n  req.onerror = error;\n  req.send(null);\n}\n\nfunction loadFont(url, cont) {\n  var font = FONT_CACHE[url];\n\n  if (font) {\n    cont(font);\n  } else {\n    loadBinary(url, function (data) {\n      if (data == null) {\n        throw new Error(\"Cannot load font from \" + url);\n      } else {\n        var font = new TTFFont(data);\n        FONT_CACHE[url] = font;\n        cont(font);\n      }\n    });\n  }\n}\n\nvar IMAGE_CACHE = {};\n\nfunction clearImageCache() {\n  IMAGE_CACHE = {};\n}\n\nfunction loadImage(url, size, cont, options) {\n  var img = IMAGE_CACHE[url],\n      bloburl,\n      blob;\n\n  if (img) {\n    cont(img);\n  } else {\n    img = new Image();\n\n    if (!/^data:/i.test(url)) {\n      img.crossOrigin = \"Anonymous\";\n    }\n\n    if (HAS_TYPED_ARRAYS && !/^data:/i.test(url)) {\n      // IE10 fails to load images from another domain even when the server sends the\n      // proper CORS headers.  a XHR, however, will be able to load the data.\n      // http://stackoverflow.com/a/19734516/154985\n      //\n      // On the other hand, it's worth doing it this way for all browsers which support\n      // responseType = \"blob\" (HAS_TYPED_ARRAYS will be true), because we can inspect the\n      // mime type and if it's a JPEG (very common case) we can save a lot of time in\n      // _load below.\n      var xhr = new XMLHttpRequest();\n\n      xhr.onload = function () {\n        blob = xhr.response;\n        bloburl = URL.createObjectURL(blob);\n\n        _load(bloburl);\n      };\n\n      xhr.onerror = _onerror;\n      xhr.open(\"GET\", url, true);\n      xhr.responseType = \"blob\";\n      xhr.send();\n    } else {\n      _load(url);\n    }\n  }\n\n  function _load(url) {\n    img.src = url;\n\n    if (img.complete && !browser.msie) {\n      // IE, bless it's little heart, says img.complete == true even though the image is\n      // not loaded (width=0), therefore we must go the onload route (ticket 929635).\n      _onload();\n    } else {\n      img.onload = _onload;\n      img.onerror = _onerror;\n    }\n  }\n\n  function _trycanvas() {\n    if (!size) {\n      size = {\n        width: img.width,\n        height: img.height\n      };\n    }\n\n    var canvas = document.createElement(\"canvas\");\n    canvas.width = size.width;\n    canvas.height = size.height;\n    var ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(img, 0, 0, size.width, size.height);\n    var imgdata;\n\n    try {\n      imgdata = ctx.getImageData(0, 0, size.width, size.height);\n    } catch (ex) {\n      // it tainted the canvas -- can't draw it.\n      _onerror();\n\n      return;\n    } finally {\n      if (bloburl) {\n        URL.revokeObjectURL(bloburl);\n      }\n    } // in case it contains transparency, we must separate rgb data from the alpha\n    // channel and create a PDFRawImage image with opacity.  otherwise we can use a\n    // PDFJpegImage.\n    //\n    // to do this in one step, we create the rgb and alpha streams anyway, even if\n    // we might end up not using them if hasAlpha remains false.\n\n\n    var hasAlpha = false,\n        rgb = BinaryStream(),\n        alpha = BinaryStream();\n    var rawbytes = imgdata.data;\n    var i = 0;\n\n    while (i < rawbytes.length) {\n      rgb.writeByte(rawbytes[i++]);\n      rgb.writeByte(rawbytes[i++]);\n      rgb.writeByte(rawbytes[i++]);\n      var a = rawbytes[i++];\n\n      if (a < 255) {\n        hasAlpha = true;\n      }\n\n      alpha.writeByte(a);\n    }\n\n    if (hasAlpha || options.keepPNG) {\n      img = new PDFRawImage(size.width, size.height, rgb, alpha);\n    } else {\n      // no transparency, encode as JPEG.\n      var data = canvas.toDataURL(\"image/jpeg\", options.jpegQuality);\n      data = data.substr(data.indexOf(\";base64,\") + 8);\n      var stream = BinaryStream();\n      stream.writeBase64(data);\n      img = new PDFJpegImage(stream);\n    }\n\n    cont(IMAGE_CACHE[url] = img);\n  }\n\n  function _onerror() {\n    cont(IMAGE_CACHE[url] = \"ERROR\");\n  }\n\n  function _onload() {\n    if (size) {\n      // but if requested size is bigger than the image, just use the original image.\n      if (size.width >= img.width || size.height >= img.height) {\n        size = null;\n      }\n    }\n\n    if (!size && blob && /^image\\/jpe?g$/i.test(blob.type)) {\n      // If we know we got a JPEG, we can skip the process of rendering it to a\n      // canvas, getting the pixel data, searching for transparency we know we won't\n      // find, getting back a data URI and then decoding the BASE64 to finally get the\n      // binary we already have.  Also, we avoid downgrading the image quality, with\n      // the possible drawback of making a bigger PDF; still, seems legit.\n      //\n      // Besides saving a lot of work, this also reuses the buffer memory\n      // (BinaryStream does not create a copy), potentially saving some GC cycles.\n      var reader = new FileReader();\n\n      reader.onload = function () {\n        try {\n          var _img = new PDFJpegImage(BinaryStream(new Uint8Array(this.result)));\n\n          URL.revokeObjectURL(bloburl);\n          cont(IMAGE_CACHE[url] = _img);\n        } catch (ex) {\n          // if there's an error parsing the JPEG stream, it could be due to a\n          // misconfigured server (improper content-type:\n          // https://github.com/telerik/kendo-ui-core/issues/4184).  If that's the case,\n          // the canvas will still be able to draw it.\n          _trycanvas();\n        }\n      };\n\n      reader.readAsArrayBuffer(blob);\n    } else {\n      _trycanvas();\n    }\n  }\n}\n\nfunction manyLoader(loadOne) {\n  return function (urls, callback) {\n    var n = urls.length,\n        i = n;\n\n    if (n === 0) {\n      return callback();\n    }\n\n    function next() {\n      if (--n === 0) {\n        callback();\n      }\n    }\n\n    while (i-- > 0) {\n      loadOne(urls[i], next);\n    }\n  };\n}\n\nvar loadFonts = manyLoader(loadFont);\n\nvar loadImages = function loadImages(images, callback, options) {\n  options = Object.assign({\n    jpegQuality: 0.92,\n    keepPNG: false\n  }, options);\n  var urls = Object.keys(images),\n      n = urls.length;\n\n  if (n === 0) {\n    return callback();\n  }\n\n  function next() {\n    if (--n === 0) {\n      callback();\n    }\n  }\n\n  urls.forEach(function (url) {\n    loadImage(url, images[url], next, options);\n  });\n};\n\nvar PDFDocument = /*#__PURE__*/function () {\n  function PDFDocument(options) {\n    _classCallCheck(this, PDFDocument);\n\n    var self = this;\n    var out = makeOutput();\n    var objcount = 0;\n    var objects = [];\n\n    function getOption(name, defval) {\n      return options && options[name] != null ? options[name] : defval;\n    }\n\n    self.getOption = getOption;\n\n    self.attach = function (value) {\n      if (objects.indexOf(value) < 0) {\n        wrapObject(value, ++objcount);\n        objects.push(value);\n      }\n\n      return value;\n    };\n\n    self.pages = [];\n    self.FONTS = {};\n    self.IMAGES = {};\n    self.GRAD_COL_FUNCTIONS = {}; // cache for color gradient functions\n\n    self.GRAD_OPC_FUNCTIONS = {}; // cache for opacity gradient functions\n\n    self.GRAD_COL = {}; // cache for whole color gradient objects\n\n    self.GRAD_OPC = {}; // cache for whole opacity gradient objects\n\n    var catalog = self.attach(new PDFCatalog());\n    var pageTree = self.attach(new PDFPageTree());\n\n    if (getOption(\"autoPrint\")) {\n      var nameTree = {};\n      nameTree.JavaScript = new PDFDictionary({\n        Names: [new PDFString(\"JS\"), self.attach(new PDFDictionary({\n          S: _(\"JavaScript\"),\n          JS: new PDFString(\"print(true);\")\n        }))]\n      });\n      catalog.props.Names = new PDFDictionary(nameTree);\n    }\n\n    catalog.setPages(pageTree);\n    var info = self.attach(new PDFDictionary({\n      Producer: new PDFString(getOption(\"producer\", \"Kendo UI PDF Generator\"), true),\n      // XXX: kendo.version?\n      Title: new PDFString(getOption(\"title\", \"\"), true),\n      Author: new PDFString(getOption(\"author\", \"\"), true),\n      Subject: new PDFString(getOption(\"subject\", \"\"), true),\n      Keywords: new PDFString(getOption(\"keywords\", \"\"), true),\n      Creator: new PDFString(getOption(\"creator\", \"Kendo UI PDF Generator\"), true),\n      CreationDate: getOption(\"date\", new Date())\n    }));\n\n    self.addPage = function (options) {\n      var paperOptions = getPaperOptions(function (name, defval) {\n        return options && options[name] != null ? options[name] : defval;\n      });\n      var paperSize = paperOptions.paperSize;\n      var margin = paperOptions.margin;\n      var contentWidth = paperSize[0];\n      var contentHeight = paperSize[1];\n\n      if (margin) {\n        contentWidth -= margin.left + margin.right;\n        contentHeight -= margin.top + margin.bottom;\n      }\n\n      var content = new PDFStream(makeOutput(), null, true);\n      var props = {\n        Contents: self.attach(content),\n        Parent: pageTree,\n        MediaBox: [0, 0, paperSize[0], paperSize[1]]\n      };\n      var page = new PDFPage(self, props);\n      page._content = content;\n      pageTree.addPage(self.attach(page)); // canvas-like coord. system.  (0,0) is upper-left.\n      // text must be vertically mirorred before drawing.\n\n      page.transform(1, 0, 0, -1, 0, paperSize[1]);\n\n      if (margin) {\n        page.translate(margin.left, margin.top); // XXX: clip to right/bottom margin.  Make this optional?\n\n        page.rect(0, 0, contentWidth, contentHeight);\n        page.clip();\n      }\n\n      self.pages.push(page);\n      return page;\n    };\n\n    self.render = function () {\n      var i; /// file header\n\n      out(\"%PDF-1.4\", NL, \"%\\xc2\\xc1\\xda\\xcf\\xce\", NL, NL); /// file body\n\n      for (i = 0; i < objects.length; ++i) {\n        objects[i].renderFull(out);\n        out(NL, NL);\n      } /// cross-reference table\n\n\n      var xrefOffset = out.offset();\n      out(\"xref\", NL, 0, \" \", objects.length + 1, NL);\n      out(\"0000000000 65535 f \", NL);\n\n      for (i = 0; i < objects.length; ++i) {\n        out(zeropad(objects[i]._offset, 10), \" 00000 n \", NL);\n      }\n\n      out(NL); /// trailer\n\n      out(\"trailer\", NL);\n      out(new PDFDictionary({\n        Size: objects.length + 1,\n        Root: catalog,\n        Info: info\n      }), NL, NL); /// end\n\n      out(\"startxref\", NL, xrefOffset, NL);\n      out(\"%%EOF\", NL);\n      return out.stream().offset(0);\n    };\n\n    self.loadFonts = loadFonts;\n    self.loadImages = loadImages;\n  }\n\n  _createClass(PDFDocument, [{\n    key: \"getFont\",\n    value: function getFont(url) {\n      var font = this.FONTS[url];\n\n      if (!font) {\n        font = FONT_CACHE[url];\n\n        if (!font) {\n          throw new Error(\"Font \" + url + \" has not been loaded\");\n        }\n\n        if (font === true) {\n          font = this.attach(new PDFStandardFont(url));\n        } else {\n          font = this.attach(new PDFFont(this, font));\n        }\n\n        this.FONTS[url] = font;\n      }\n\n      return font;\n    }\n  }, {\n    key: \"getImage\",\n    value: function getImage(url) {\n      var img = this.IMAGES[url];\n\n      if (!img) {\n        img = IMAGE_CACHE[url];\n\n        if (!img) {\n          throw new Error(\"Image \" + url + \" has not been loaded\");\n        }\n\n        if (img === \"ERROR\") {\n          return null;\n        }\n\n        img = this.IMAGES[url] = this.attach(img.asStream(this));\n      }\n\n      return img;\n    }\n  }, {\n    key: \"getOpacityGS\",\n    value: function getOpacityGS(opacity, forStroke) {\n      var id = parseFloat(opacity).toFixed(3);\n      opacity = parseFloat(id);\n      id += forStroke ? \"S\" : \"F\";\n      var cache = this._opacityGSCache || (this._opacityGSCache = {});\n      var gs = cache[id];\n\n      if (!gs) {\n        var props = {\n          Type: _(\"ExtGState\")\n        };\n\n        if (forStroke) {\n          props.CA = opacity;\n        } else {\n          props.ca = opacity;\n        }\n\n        gs = this.attach(new PDFDictionary(props));\n        gs._resourceName = _(\"GS\" + ++RESOURCE_COUNTER);\n        cache[id] = gs;\n      }\n\n      return gs;\n    }\n  }, {\n    key: \"dict\",\n    value: function dict(props) {\n      return new PDFDictionary(props);\n    }\n  }, {\n    key: \"name\",\n    value: function name(str) {\n      return _(str);\n    }\n  }, {\n    key: \"stream\",\n    value: function stream(props, content) {\n      return new PDFStream(content, props);\n    }\n  }]);\n\n  return PDFDocument;\n}();\n/* -----[ utils ]----- */\n\n\nfunction pad(str, len, ch) {\n  while (str.length < len) {\n    str = ch + str;\n  }\n\n  return str;\n}\n\nfunction zeropad(n, len) {\n  return pad(String(n), len, \"0\");\n}\n\nfunction hasOwnProperty(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nvar isArray = Array.isArray || function (obj) {\n  return obj instanceof Array;\n};\n\nfunction isDate(obj) {\n  return obj instanceof Date;\n}\n\nfunction renderArray(a, out) {\n  out(\"[\");\n\n  if (a.length > 0) {\n    out.withIndent(function () {\n      for (var i = 0; i < a.length; ++i) {\n        if (i > 0 && i % 8 === 0) {\n          out.indent(a[i]);\n        } else {\n          out(\" \", a[i]);\n        }\n      }\n    }); //out.indent();\n  }\n\n  out(\" ]\");\n}\n\nfunction renderDate(date, out) {\n  out(\"(D:\", zeropad(date.getUTCFullYear(), 4), zeropad(date.getUTCMonth() + 1, 2), zeropad(date.getUTCDate(), 2), zeropad(date.getUTCHours(), 2), zeropad(date.getUTCMinutes(), 2), zeropad(date.getUTCSeconds(), 2), \"Z)\");\n}\n\nfunction mm2pt(mm) {\n  return mm * (72 / 25.4);\n}\n\nfunction cm2pt(cm) {\n  return mm2pt(cm * 10);\n}\n\nfunction in2pt(inch) {\n  return inch * 72;\n}\n\nfunction unitsToPoints(x, def) {\n  if (typeof x == \"number\") {\n    return x;\n  }\n\n  if (typeof x == \"string\") {\n    var m;\n    m = /^\\s*([0-9.]+)\\s*(mm|cm|in|pt)\\s*$/.exec(x);\n\n    if (m) {\n      var num = parseFloat(m[1]);\n\n      if (!isNaN(num)) {\n        if (m[2] == \"pt\") {\n          return num;\n        }\n\n        return {\n          \"mm\": mm2pt,\n          \"cm\": cm2pt,\n          \"in\": in2pt\n        }[m[2]](num);\n      }\n    }\n  }\n\n  if (def != null) {\n    return def;\n  }\n\n  throw new Error(\"Can't parse unit: \" + x);\n}\n/* -----[ PDF basic objects ]----- */\n\n\nvar PDFValue = /*#__PURE__*/function () {\n  function PDFValue() {\n    _classCallCheck(this, PDFValue);\n  }\n\n  _createClass(PDFValue, [{\n    key: \"beforeRender\",\n    value: function beforeRender() {}\n  }]);\n\n  return PDFValue;\n}();\n\nvar PDFString = /*#__PURE__*/function (_PDFValue) {\n  _inherits(PDFString, _PDFValue);\n\n  var _super = _createSuper(PDFString);\n\n  function PDFString(value, utf16be) {\n    var _this;\n\n    _classCallCheck(this, PDFString);\n\n    _this = _super.call(this);\n    _this.value = value;\n    _this.utf16be = Boolean(utf16be);\n    return _this;\n  }\n\n  _createClass(PDFString, [{\n    key: \"render\",\n    value: function render(out) {\n      var txt = this.value;\n\n      if (this.utf16be) {\n        txt = BOM + encodeUTF16BE(txt);\n        txt = txt.replace(/([\\(\\)\\\\])/g, \"\\\\$1\");\n        out(\"(\", txt, \")\");\n      } else {\n        // out.writeString truncates charcodes to 8 bits and\n        // 0x128 & 0xFF is 40, the code for open paren.\n        // therefore we need to do the chopping here to make\n        // sure we backslash all cases.\n        var data = [40]; // open PDF string '('\n\n        for (var i = 0; i < txt.length; ++i) {\n          var code = txt.charCodeAt(i) & 0xFF;\n\n          if (code == 40 || code == 41 || code == 92) {\n            // backslash before (, ) and \\\n            data.push(92);\n          }\n\n          data.push(code);\n        }\n\n        data.push(41); // ')' close PDF string\n\n        out.writeData(data);\n      }\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      return this.value;\n    }\n  }]);\n\n  return PDFString;\n}(PDFValue);\n\nvar PDFHexString = /*#__PURE__*/function (_PDFString) {\n  _inherits(PDFHexString, _PDFString);\n\n  var _super2 = _createSuper(PDFHexString);\n\n  function PDFHexString(value) {\n    var _this2;\n\n    _classCallCheck(this, PDFHexString);\n\n    _this2 = _super2.call(this, value);\n    _this2.value = value;\n    return _this2;\n  }\n\n  _createClass(PDFHexString, [{\n    key: \"render\",\n    value: function render(out) {\n      out(\"<\");\n\n      for (var i = 0; i < this.value.length; ++i) {\n        out(zeropad(this.value.charCodeAt(i).toString(16), 4));\n      }\n\n      out(\">\");\n    }\n  }]);\n\n  return PDFHexString;\n}(PDFString); /// names\n\n\nvar PDFName = /*#__PURE__*/function (_PDFValue2) {\n  _inherits(PDFName, _PDFValue2);\n\n  var _super3 = _createSuper(PDFName);\n\n  _createClass(PDFName, null, [{\n    key: \"get\",\n    value: function get(name) {\n      return _(name);\n    }\n  }]);\n\n  function PDFName(name) {\n    var _this3;\n\n    _classCallCheck(this, PDFName);\n\n    _this3 = _super3.call(this);\n    _this3.name = name;\n    return _this3;\n  }\n\n  _createClass(PDFName, [{\n    key: \"render\",\n    value: function render(out) {\n      out(\"/\" + this.escape());\n    }\n  }, {\n    key: \"escape\",\n    value: function escape() {\n      return this.name.replace(/[^\\x21-\\x7E]/g, function (c) {\n        return \"#\" + zeropad(c.charCodeAt(0).toString(16), 2);\n      });\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      return this.name;\n    }\n  }]);\n\n  return PDFName;\n}(PDFValue);\n\nvar PDFName_cache = {};\n\nfunction _(name) {\n  if (hasOwnProperty(PDFName_cache, name)) {\n    return PDFName_cache[name];\n  }\n\n  return PDFName_cache[name] = new PDFName(name);\n} /// dictionary\n\n\nvar PDFDictionary = /*#__PURE__*/function (_PDFValue3) {\n  _inherits(PDFDictionary, _PDFValue3);\n\n  var _super4 = _createSuper(PDFDictionary);\n\n  function PDFDictionary(props) {\n    var _this4;\n\n    _classCallCheck(this, PDFDictionary);\n\n    _this4 = _super4.call(this);\n    _this4.props = props;\n    return _this4;\n  }\n\n  _createClass(PDFDictionary, [{\n    key: \"render\",\n    value: function render(out) {\n      var props = this.props,\n          empty = true;\n      out(\"<<\");\n      out.withIndent(function () {\n        for (var i in props) {\n          if (hasOwnProperty(props, i) && !/^_/.test(i)) {\n            empty = false;\n            out.indent(_(i), \" \", props[i]);\n          }\n        }\n      });\n\n      if (!empty) {\n        out.indent();\n      }\n\n      out(\">>\");\n    }\n  }]);\n\n  return PDFDictionary;\n}(PDFValue); /// streams\n\n\nvar PDFStream = /*#__PURE__*/function (_PDFValue4) {\n  _inherits(PDFStream, _PDFValue4);\n\n  var _super5 = _createSuper(PDFStream);\n\n  function PDFStream(data, props, compress) {\n    var _this5;\n\n    _classCallCheck(this, PDFStream);\n\n    _this5 = _super5.call(this);\n\n    if (typeof data == \"string\") {\n      var tmp = BinaryStream();\n      tmp.write(data);\n      data = tmp;\n    }\n\n    _this5.data = data;\n    _this5.props = props || {};\n    _this5.compress = compress;\n    return _this5;\n  }\n\n  _createClass(PDFStream, [{\n    key: \"render\",\n    value: function render(out) {\n      var data = this.data.get(),\n          props = this.props;\n\n      if (this.compress && supportsDeflate()) {\n        if (!props.Filter) {\n          props.Filter = [];\n        } else if (!(props.Filter instanceof Array)) {\n          props.Filter = [props.Filter];\n        }\n\n        props.Filter.unshift(_(\"FlateDecode\"));\n        data = deflate(data);\n      }\n\n      props.Length = data.length;\n      out(new PDFDictionary(props), \" stream\", NL);\n      out.writeData(data);\n      out(NL, \"endstream\");\n    }\n  }]);\n\n  return PDFStream;\n}(PDFValue); /// catalog\n\n\nvar PDFCatalog = /*#__PURE__*/function (_PDFDictionary) {\n  _inherits(PDFCatalog, _PDFDictionary);\n\n  var _super6 = _createSuper(PDFCatalog);\n\n  function PDFCatalog() {\n    _classCallCheck(this, PDFCatalog);\n\n    return _super6.call(this, {\n      Type: _(\"Catalog\")\n    });\n  }\n\n  _createClass(PDFCatalog, [{\n    key: \"setPages\",\n    value: function setPages(pagesObj) {\n      this.props.Pages = pagesObj;\n    }\n  }]);\n\n  return PDFCatalog;\n}(PDFDictionary); /// page tree\n\n\nvar PDFPageTree = /*#__PURE__*/function (_PDFDictionary2) {\n  _inherits(PDFPageTree, _PDFDictionary2);\n\n  var _super7 = _createSuper(PDFPageTree);\n\n  function PDFPageTree() {\n    _classCallCheck(this, PDFPageTree);\n\n    return _super7.call(this, {\n      Type: _(\"Pages\"),\n      Kids: [],\n      Count: 0\n    });\n  }\n\n  _createClass(PDFPageTree, [{\n    key: \"addPage\",\n    value: function addPage(pageObj) {\n      this.props.Kids.push(pageObj);\n      this.props.Count++;\n    }\n  }]);\n\n  return PDFPageTree;\n}(PDFDictionary); /// images\n// JPEG\n\n\nvar SOF_CODES = [0xc0, 0xc1, 0xc2, 0xc3, 0xc5, 0xc6, 0xc7, 0xc9, 0xca, 0xcb, 0xcd, 0xce, 0xcf];\n\nvar PDFJpegImage = function PDFJpegImage(data) {\n  _classCallCheck(this, PDFJpegImage);\n\n  // we must determine the correct color space.  we'll parse a bit\n  // of the JPEG stream for this, it's still better than going\n  // through the canvas.\n  // https://github.com/telerik/kendo-ui-core/issues/2845\n  data.offset(0);\n  var width, height, colorSpace, bitsPerComponent;\n  var soi = data.readShort();\n\n  if (soi != 0xFFD8) {\n    // XXX: do we have some better options here?\n    throw new Error(\"Invalid JPEG image\");\n  }\n\n  while (!data.eof()) {\n    var ff = data.readByte();\n\n    if (ff != 0xFF) {\n      throw new Error(\"Invalid JPEG image\");\n    }\n\n    var marker = data.readByte();\n    var length = data.readShort();\n\n    if (SOF_CODES.indexOf(marker) >= 0) {\n      // \"start of frame\" marker\n      bitsPerComponent = data.readByte();\n      height = data.readShort();\n      width = data.readShort();\n      colorSpace = data.readByte();\n      break;\n    }\n\n    data.skip(length - 2);\n  }\n\n  if (colorSpace == null) {\n    throw new Error(\"Invalid JPEG image\");\n  }\n\n  var props = {\n    Type: _(\"XObject\"),\n    Subtype: _(\"Image\"),\n    Width: width,\n    Height: height,\n    BitsPerComponent: bitsPerComponent,\n    Filter: _(\"DCTDecode\")\n  };\n\n  switch (colorSpace) {\n    case 1:\n      props.ColorSpace = _(\"DeviceGray\");\n      break;\n\n    case 3:\n      props.ColorSpace = _(\"DeviceRGB\");\n      break;\n\n    case 4:\n      props.ColorSpace = _(\"DeviceCMYK\");\n      props.Decode = [1, 0, 1, 0, 1, 0, 1, 0]; // invert colors\n\n      break;\n  }\n\n  this.asStream = function () {\n    data.offset(0);\n    var stream = new PDFStream(data, props);\n    stream._resourceName = _(\"I\" + ++RESOURCE_COUNTER);\n    return stream;\n  };\n}; // PDFRawImage will be used for images with transparency (PNG)\n\n\nvar PDFRawImage = function PDFRawImage(width, height, rgb, alpha) {\n  _classCallCheck(this, PDFRawImage);\n\n  this.asStream = function (pdf) {\n    var mask = new PDFStream(alpha, {\n      Type: _(\"XObject\"),\n      Subtype: _(\"Image\"),\n      Width: width,\n      Height: height,\n      BitsPerComponent: 8,\n      ColorSpace: _(\"DeviceGray\")\n    }, true);\n    var stream = new PDFStream(rgb, {\n      Type: _(\"XObject\"),\n      Subtype: _(\"Image\"),\n      Width: width,\n      Height: height,\n      BitsPerComponent: 8,\n      ColorSpace: _(\"DeviceRGB\"),\n      SMask: pdf.attach(mask)\n    }, true);\n    stream._resourceName = _(\"I\" + ++RESOURCE_COUNTER);\n    return stream;\n  };\n}; /// standard fonts\n\n\nvar PDFStandardFont = /*#__PURE__*/function (_PDFDictionary3) {\n  _inherits(PDFStandardFont, _PDFDictionary3);\n\n  var _super8 = _createSuper(PDFStandardFont);\n\n  function PDFStandardFont(name) {\n    var _this6;\n\n    _classCallCheck(this, PDFStandardFont);\n\n    _this6 = _super8.call(this, {\n      Type: _(\"Font\"),\n      Subtype: _(\"Type1\"),\n      BaseFont: _(name)\n    });\n    _this6._resourceName = _(\"F\" + ++RESOURCE_COUNTER);\n    return _this6;\n  }\n\n  _createClass(PDFStandardFont, [{\n    key: \"encodeText\",\n    value: function encodeText(str) {\n      return new PDFString(String(str));\n    }\n  }]);\n\n  return PDFStandardFont;\n}(PDFDictionary); /// TTF fonts\n\n\nvar PDFFont = /*#__PURE__*/function (_PDFDictionary4) {\n  _inherits(PDFFont, _PDFDictionary4);\n\n  var _super9 = _createSuper(PDFFont);\n\n  function PDFFont(pdf, font, props) {\n    var _this7;\n\n    _classCallCheck(this, PDFFont);\n\n    _this7 = _super9.call(this, {});\n    props = _this7.props;\n    props.Type = _(\"Font\");\n    props.Subtype = _(\"Type0\");\n    props.Encoding = _(\"Identity-H\");\n    _this7._pdf = pdf;\n    _this7._font = font;\n    _this7._sub = font.makeSubset();\n    _this7._resourceName = _(\"F\" + ++RESOURCE_COUNTER);\n    var head = font.head;\n    _this7.name = font.psName;\n    var scale = _this7.scale = font.scale;\n    _this7.bbox = [head.xMin * scale, head.yMin * scale, head.xMax * scale, head.yMax * scale];\n    _this7.italicAngle = font.post.italicAngle;\n    _this7.ascent = font.ascent * scale;\n    _this7.descent = font.descent * scale;\n    _this7.lineGap = font.lineGap * scale;\n    _this7.capHeight = font.os2.capHeight || _this7.ascent;\n    _this7.xHeight = font.os2.xHeight || 0;\n    _this7.stemV = 0;\n    _this7.familyClass = (font.os2.familyClass || 0) >> 8;\n    _this7.isSerif = _this7.familyClass >= 1 && _this7.familyClass <= 7;\n    _this7.isScript = _this7.familyClass == 10;\n    _this7.flags = (font.post.isFixedPitch ? 1 : 0) | (_this7.isSerif ? 1 << 1 : 0) | (_this7.isScript ? 1 << 3 : 0) | (_this7.italicAngle !== 0 ? 1 << 6 : 0) | 1 << 5;\n    return _this7;\n  }\n\n  _createClass(PDFFont, [{\n    key: \"encodeText\",\n    value: function encodeText(text) {\n      return new PDFHexString(this._sub.encodeText(String(text)));\n    }\n  }, {\n    key: \"getTextWidth\",\n    value: function getTextWidth(fontSize, text) {\n      var width = 0,\n          codeMap = this._font.cmap.codeMap;\n\n      for (var i = 0; i < text.length; ++i) {\n        var glyphId = codeMap[text.charCodeAt(i)];\n        width += this._font.widthOfGlyph(glyphId || 0);\n      }\n\n      return width * fontSize / 1000;\n    }\n  }, {\n    key: \"beforeRender\",\n    value: function beforeRender() {\n      var self = this;\n      var sub = self._sub; // write the TTF data\n\n      var data = sub.render();\n      var fontStream = new PDFStream(BinaryStream(data), {\n        Length1: data.length\n      }, true);\n\n      var descriptor = self._pdf.attach(new PDFDictionary({\n        Type: _(\"FontDescriptor\"),\n        FontName: _(self._sub.psName),\n        FontBBox: self.bbox,\n        Flags: self.flags,\n        StemV: self.stemV,\n        ItalicAngle: self.italicAngle,\n        Ascent: self.ascent,\n        Descent: self.descent,\n        CapHeight: self.capHeight,\n        XHeight: self.xHeight,\n        FontFile2: self._pdf.attach(fontStream)\n      }));\n\n      var cmap = sub.ncid2ogid;\n      var firstChar = sub.firstChar;\n      var lastChar = sub.lastChar;\n      var charWidths = [];\n\n      (function loop(i, chunk) {\n        if (i <= lastChar) {\n          var gid = cmap[i];\n\n          if (gid == null) {\n            loop(i + 1);\n          } else {\n            if (!chunk) {\n              charWidths.push(i, chunk = []);\n            }\n\n            chunk.push(self._font.widthOfGlyph(gid));\n            loop(i + 1, chunk);\n          }\n        }\n      })(firstChar); // As if two dictionaries weren't enough, we need another\n      // one, the \"descendant font\".  Only that one can be of\n      // Subtype CIDFontType2.  PDF is the X11 of document\n      // formats: portable but full of legacy that nobody cares\n      // about anymore.\n\n\n      var descendant = new PDFDictionary({\n        Type: _(\"Font\"),\n        Subtype: _(\"CIDFontType2\"),\n        BaseFont: _(self._sub.psName),\n        CIDSystemInfo: new PDFDictionary({\n          Registry: new PDFString(\"Adobe\"),\n          Ordering: new PDFString(\"Identity\"),\n          Supplement: 0\n        }),\n        FontDescriptor: descriptor,\n        FirstChar: firstChar,\n        LastChar: lastChar,\n        DW: Math.round(self._font.widthOfGlyph(0)),\n        W: charWidths,\n        CIDToGIDMap: self._pdf.attach(self._makeCidToGidMap())\n      });\n      var dict = self.props;\n      dict.BaseFont = _(self._sub.psName);\n      dict.DescendantFonts = [self._pdf.attach(descendant)]; // Compute the ToUnicode map so that apps can extract\n      // meaningful text from the PDF.\n\n      var unimap = new PDFToUnicodeCmap(firstChar, lastChar, sub.subset);\n      var unimapStream = new PDFStream(makeOutput(), null, true);\n      unimapStream.data(unimap);\n      dict.ToUnicode = self._pdf.attach(unimapStream);\n    }\n  }, {\n    key: \"_makeCidToGidMap\",\n    value: function _makeCidToGidMap() {\n      return new PDFStream(BinaryStream(this._sub.cidToGidMap()), null, true);\n    }\n  }]);\n\n  return PDFFont;\n}(PDFDictionary);\n\nvar PDFToUnicodeCmap = /*#__PURE__*/function (_PDFValue5) {\n  _inherits(PDFToUnicodeCmap, _PDFValue5);\n\n  var _super10 = _createSuper(PDFToUnicodeCmap);\n\n  function PDFToUnicodeCmap(firstChar, lastChar, map) {\n    var _this8;\n\n    _classCallCheck(this, PDFToUnicodeCmap);\n\n    _this8 = _super10.call(this);\n    _this8.firstChar = firstChar;\n    _this8.lastChar = lastChar;\n    _this8.map = map;\n    return _this8;\n  }\n\n  _createClass(PDFToUnicodeCmap, [{\n    key: \"render\",\n    value: function render(out) {\n      out.indent(\"/CIDInit /ProcSet findresource begin\");\n      out.indent(\"12 dict begin\");\n      out.indent(\"begincmap\");\n      out.indent(\"/CIDSystemInfo <<\");\n      out.indent(\"  /Registry (Adobe)\");\n      out.indent(\"  /Ordering (UCS)\");\n      out.indent(\"  /Supplement 0\");\n      out.indent(\">> def\");\n      out.indent(\"/CMapName /Adobe-Identity-UCS def\");\n      out.indent(\"/CMapType 2 def\");\n      out.indent(\"1 begincodespacerange\");\n      out.indent(\"  <0000><ffff>\");\n      out.indent(\"endcodespacerange\");\n      var self = this;\n      out.indent(self.lastChar - self.firstChar + 1, \" beginbfchar\");\n      out.withIndent(function () {\n        for (var code = self.firstChar; code <= self.lastChar; ++code) {\n          var unicode = self.map[code];\n          var str = ucs2encode([unicode]);\n          out.indent(\"<\", zeropad(code.toString(16), 4), \">\", \"<\");\n\n          for (var i = 0; i < str.length; ++i) {\n            out(zeropad(str.charCodeAt(i).toString(16), 4));\n          }\n\n          out(\">\");\n        }\n      });\n      out.indent(\"endbfchar\");\n      out.indent(\"endcmap\");\n      out.indent(\"CMapName currentdict /CMap defineresource pop\");\n      out.indent(\"end\");\n      out.indent(\"end\");\n    }\n  }]);\n\n  return PDFToUnicodeCmap;\n}(PDFValue); /// gradients\n\n\nfunction makeHash(a) {\n  return a.map(function (x) {\n    return isArray(x) ? makeHash(x) : typeof x == \"number\" ? (Math.round(x * 1000) / 1000).toFixed(3) : x;\n  }).join(\" \");\n}\n\nfunction cacheColorGradientFunction(pdf, r1, g1, b1, r2, g2, b2) {\n  var hash = makeHash([r1, g1, b1, r2, g2, b2]);\n  var func = pdf.GRAD_COL_FUNCTIONS[hash];\n\n  if (!func) {\n    func = pdf.GRAD_COL_FUNCTIONS[hash] = pdf.attach(new PDFDictionary({\n      FunctionType: 2,\n      Domain: [0, 1],\n      Range: [0, 1, 0, 1, 0, 1],\n      N: 1,\n      C0: [r1, g1, b1],\n      C1: [r2, g2, b2]\n    }));\n  }\n\n  return func;\n}\n\nfunction cacheOpacityGradientFunction(pdf, a1, a2) {\n  var hash = makeHash([a1, a2]);\n  var func = pdf.GRAD_OPC_FUNCTIONS[hash];\n\n  if (!func) {\n    func = pdf.GRAD_OPC_FUNCTIONS[hash] = pdf.attach(new PDFDictionary({\n      FunctionType: 2,\n      Domain: [0, 1],\n      Range: [0, 1],\n      N: 1,\n      C0: [a1],\n      C1: [a2]\n    }));\n  }\n\n  return func;\n}\n\nfunction makeGradientFunctions(pdf, stops) {\n  var hasAlpha = false;\n  var opacities = [];\n  var colors = [];\n  var offsets = [];\n  var encode = [];\n  var i, prev, cur, prevColor, curColor;\n\n  for (i = 1; i < stops.length; ++i) {\n    prev = stops[i - 1];\n    cur = stops[i];\n    prevColor = prev.color;\n    curColor = cur.color;\n    colors.push(cacheColorGradientFunction(pdf, prevColor.r, prevColor.g, prevColor.b, curColor.r, curColor.g, curColor.b));\n\n    if (prevColor.a < 1 || curColor.a < 1) {\n      hasAlpha = true;\n    }\n\n    offsets.push(cur.offset);\n    encode.push(0, 1);\n  }\n\n  if (hasAlpha) {\n    for (i = 1; i < stops.length; ++i) {\n      prev = stops[i - 1];\n      cur = stops[i];\n      prevColor = prev.color;\n      curColor = cur.color;\n      opacities.push(cacheOpacityGradientFunction(pdf, prevColor.a, curColor.a));\n    }\n  }\n\n  offsets.pop();\n  return {\n    hasAlpha: hasAlpha,\n    colors: assemble(colors),\n    opacities: hasAlpha ? assemble(opacities) : null\n  };\n\n  function assemble(funcs) {\n    if (funcs.length == 1) {\n      return funcs[0];\n    }\n\n    return {\n      FunctionType: 3,\n      Functions: funcs,\n      Domain: [0, 1],\n      Bounds: offsets,\n      Encode: encode\n    };\n  }\n}\n\nfunction cacheColorGradient(pdf, isRadial, stops, coords, funcs, box) {\n  var shading, hash; // if box is given then we have user-space coordinates, which\n  // means the gradient is designed for a certain position/size\n  // on page.  caching won't do any good.\n\n  if (!box) {\n    var a = [isRadial].concat(coords);\n    stops.forEach(function (x) {\n      a.push(x.offset, x.color.r, x.color.g, x.color.b);\n    });\n    hash = makeHash(a);\n    shading = pdf.GRAD_COL[hash];\n  }\n\n  if (!shading) {\n    shading = new PDFDictionary({\n      Type: _(\"Shading\"),\n      ShadingType: isRadial ? 3 : 2,\n      ColorSpace: _(\"DeviceRGB\"),\n      Coords: coords,\n      Domain: [0, 1],\n      Function: funcs,\n      Extend: [true, true]\n    });\n    pdf.attach(shading);\n    shading._resourceName = \"S\" + ++RESOURCE_COUNTER;\n\n    if (hash) {\n      pdf.GRAD_COL[hash] = shading;\n    }\n  }\n\n  return shading;\n}\n\nfunction cacheOpacityGradient(pdf, isRadial, stops, coords, funcs, box) {\n  var opacity, hash; // if box is given then we have user-space coordinates, which\n  // means the gradient is designed for a certain position/size\n  // on page.  caching won't do any good.\n\n  if (!box) {\n    var a = [isRadial].concat(coords);\n    stops.forEach(function (x) {\n      a.push(x.offset, x.color.a);\n    });\n    hash = makeHash(a);\n    opacity = pdf.GRAD_OPC[hash];\n  }\n\n  if (!opacity) {\n    opacity = new PDFDictionary({\n      Type: _(\"ExtGState\"),\n      AIS: false,\n      CA: 1,\n      ca: 1,\n      SMask: {\n        Type: _(\"Mask\"),\n        S: _(\"Luminosity\"),\n        G: pdf.attach(new PDFStream(\"/a0 gs /s0 sh\", {\n          Type: _(\"XObject\"),\n          Subtype: _(\"Form\"),\n          FormType: 1,\n          BBox: box ? [box.left, box.top + box.height, box.left + box.width, box.top] : [0, 1, 1, 0],\n          Group: {\n            Type: _(\"Group\"),\n            S: _(\"Transparency\"),\n            CS: _(\"DeviceGray\"),\n            I: true\n          },\n          Resources: {\n            ExtGState: {\n              a0: {\n                CA: 1,\n                ca: 1\n              }\n            },\n            Shading: {\n              s0: {\n                ColorSpace: _(\"DeviceGray\"),\n                Coords: coords,\n                Domain: [0, 1],\n                ShadingType: isRadial ? 3 : 2,\n                Function: funcs,\n                Extend: [true, true]\n              }\n            }\n          }\n        }))\n      }\n    });\n    pdf.attach(opacity);\n    opacity._resourceName = \"O\" + ++RESOURCE_COUNTER;\n\n    if (hash) {\n      pdf.GRAD_OPC[hash] = opacity;\n    }\n  }\n\n  return opacity;\n}\n\nfunction cacheGradient(pdf, gradient, box) {\n  var isRadial = gradient.type == \"radial\";\n  var funcs = makeGradientFunctions(pdf, gradient.stops);\n  var coords = isRadial ? [gradient.start.x, gradient.start.y, gradient.start.r, gradient.end.x, gradient.end.y, gradient.end.r] : [gradient.start.x, gradient.start.y, gradient.end.x, gradient.end.y];\n  var shading = cacheColorGradient(pdf, isRadial, gradient.stops, coords, funcs.colors, gradient.userSpace && box);\n  var opacity = funcs.hasAlpha ? cacheOpacityGradient(pdf, isRadial, gradient.stops, coords, funcs.opacities, gradient.userSpace && box) : null;\n  return {\n    hasAlpha: funcs.hasAlpha,\n    shading: shading,\n    opacity: opacity\n  };\n} /// page object\n\n\nvar PDFPage = /*#__PURE__*/function (_PDFDictionary5) {\n  _inherits(PDFPage, _PDFDictionary5);\n\n  var _super11 = _createSuper(PDFPage);\n\n  function PDFPage(pdf, props) {\n    var _this9;\n\n    _classCallCheck(this, PDFPage);\n\n    _this9 = _super11.call(this, props);\n    _this9._pdf = pdf;\n    _this9._rcount = 0;\n    _this9._textMode = false;\n    _this9._fontResources = {};\n    _this9._gsResources = {};\n    _this9._xResources = {};\n    _this9._patResources = {};\n    _this9._shResources = {};\n    _this9._opacity = 1;\n    _this9._matrix = [1, 0, 0, 1, 0, 0];\n    _this9._annotations = [];\n    _this9._font = null;\n    _this9._fontSize = null;\n    _this9._contextStack = [];\n    props = _this9.props;\n    props.Type = _(\"Page\");\n    props.ProcSet = [_(\"PDF\"), _(\"Text\"), _(\"ImageB\"), _(\"ImageC\"), _(\"ImageI\")];\n    props.Resources = new PDFDictionary({\n      Font: new PDFDictionary(_this9._fontResources),\n      ExtGState: new PDFDictionary(_this9._gsResources),\n      XObject: new PDFDictionary(_this9._xResources),\n      Pattern: new PDFDictionary(_this9._patResources),\n      Shading: new PDFDictionary(_this9._shResources)\n    });\n    props.Annots = _this9._annotations;\n    return _this9;\n  }\n\n  _createClass(PDFPage, [{\n    key: \"_out\",\n    value: function _out() {\n      this._content.data.apply(null, arguments);\n    }\n  }, {\n    key: \"transform\",\n    value: function transform(a, b, c, d, e, f) {\n      if (!isIdentityMatrix(arguments)) {\n        this._matrix = mmul(arguments, this._matrix);\n\n        this._out(a, \" \", b, \" \", c, \" \", d, \" \", e, \" \", f, \" cm\"); // XXX: debug\n        // this._out(\" % current matrix: \", this._matrix);\n\n\n        this._out(NL);\n      }\n    }\n  }, {\n    key: \"translate\",\n    value: function translate(dx, dy) {\n      this.transform(1, 0, 0, 1, dx, dy);\n    }\n  }, {\n    key: \"scale\",\n    value: function scale(sx, sy) {\n      this.transform(sx, 0, 0, sy, 0, 0);\n    }\n  }, {\n    key: \"rotate\",\n    value: function rotate(angle) {\n      var cos = Math.cos(angle),\n          sin = Math.sin(angle);\n      this.transform(cos, sin, -sin, cos, 0, 0);\n    }\n  }, {\n    key: \"beginText\",\n    value: function beginText() {\n      this._textMode = true;\n\n      this._out(\"BT\", NL);\n    }\n  }, {\n    key: \"endText\",\n    value: function endText() {\n      this._textMode = false;\n\n      this._out(\"ET\", NL);\n    }\n  }, {\n    key: \"_requireTextMode\",\n    value: function _requireTextMode() {\n      if (!this._textMode) {\n        throw new Error(\"Text mode required; call page.beginText() first\");\n      }\n    }\n  }, {\n    key: \"_requireFont\",\n    value: function _requireFont() {\n      if (!this._font) {\n        throw new Error(\"No font selected; call page.setFont() first\");\n      }\n    }\n  }, {\n    key: \"setFont\",\n    value: function setFont(font, size) {\n      this._requireTextMode();\n\n      if (font == null) {\n        font = this._font;\n      } else if (!(font instanceof PDFFont)) {\n        font = this._pdf.getFont(font);\n      }\n\n      if (size == null) {\n        size = this._fontSize;\n      }\n\n      this._fontResources[font._resourceName] = font;\n      this._font = font;\n      this._fontSize = size;\n\n      this._out(font._resourceName, \" \", size, \" Tf\", NL);\n    }\n  }, {\n    key: \"setTextLeading\",\n    value: function setTextLeading(size) {\n      this._requireTextMode();\n\n      this._out(size, \" TL\", NL);\n    }\n  }, {\n    key: \"setTextRenderingMode\",\n    value: function setTextRenderingMode(mode) {\n      this._requireTextMode();\n\n      this._out(mode, \" Tr\", NL);\n    }\n  }, {\n    key: \"showText\",\n    value: function showText(text, requestedWidth) {\n      this._requireFont();\n\n      if (text.length > 1 && requestedWidth && this._font instanceof PDFFont) {\n        var outputWidth = this._font.getTextWidth(this._fontSize, text);\n\n        var scale = requestedWidth / outputWidth * 100;\n\n        this._out(scale, \" Tz \");\n      }\n\n      this._out(this._font.encodeText(text), \" Tj\", NL);\n    }\n  }, {\n    key: \"showTextNL\",\n    value: function showTextNL(text) {\n      this._requireFont();\n\n      this._out(this._font.encodeText(text), \" '\", NL);\n    }\n  }, {\n    key: \"addLink\",\n    value: function addLink(uri, box) {\n      var ll = this._toPage({\n        x: box.left,\n        y: box.bottom\n      });\n\n      var ur = this._toPage({\n        x: box.right,\n        y: box.top\n      });\n\n      this._annotations.push(new PDFDictionary({\n        Type: _(\"Annot\"),\n        Subtype: _(\"Link\"),\n        Rect: [ll.x, ll.y, ur.x, ur.y],\n        Border: [0, 0, 0],\n        A: new PDFDictionary({\n          Type: _(\"Action\"),\n          S: _(\"URI\"),\n          URI: new PDFString(uri)\n        })\n      }));\n    }\n  }, {\n    key: \"setStrokeColor\",\n    value: function setStrokeColor(r, g, b) {\n      this._out(r, \" \", g, \" \", b, \" RG\", NL);\n    }\n  }, {\n    key: \"setOpacity\",\n    value: function setOpacity(opacity) {\n      this.setFillOpacity(opacity);\n      this.setStrokeOpacity(opacity);\n      this._opacity *= opacity;\n    }\n  }, {\n    key: \"setStrokeOpacity\",\n    value: function setStrokeOpacity(opacity) {\n      if (opacity < 1) {\n        var gs = this._pdf.getOpacityGS(this._opacity * opacity, true);\n\n        this._gsResources[gs._resourceName] = gs;\n\n        this._out(gs._resourceName, \" gs\", NL);\n      }\n    }\n  }, {\n    key: \"setFillColor\",\n    value: function setFillColor(r, g, b) {\n      this._out(r, \" \", g, \" \", b, \" rg\", NL);\n    }\n  }, {\n    key: \"setFillOpacity\",\n    value: function setFillOpacity(opacity) {\n      if (opacity < 1) {\n        var gs = this._pdf.getOpacityGS(this._opacity * opacity, false);\n\n        this._gsResources[gs._resourceName] = gs;\n\n        this._out(gs._resourceName, \" gs\", NL);\n      }\n    }\n  }, {\n    key: \"gradient\",\n    value: function gradient(_gradient, box) {\n      this.save();\n      this.rect(box.left, box.top, box.width, box.height);\n      this.clip();\n\n      if (!_gradient.userSpace) {\n        this.transform(box.width, 0, 0, box.height, box.left, box.top);\n      }\n\n      var g = cacheGradient(this._pdf, _gradient, box);\n      var sname = g.shading._resourceName,\n          oname;\n      this._shResources[sname] = g.shading;\n\n      if (g.hasAlpha) {\n        oname = g.opacity._resourceName;\n        this._gsResources[oname] = g.opacity;\n\n        this._out(\"/\" + oname + \" gs \");\n      }\n\n      this._out(\"/\" + sname + \" sh\", NL);\n\n      this.restore();\n    }\n  }, {\n    key: \"setDashPattern\",\n    value: function setDashPattern(dashArray, dashPhase) {\n      this._out(dashArray, \" \", dashPhase, \" d\", NL);\n    }\n  }, {\n    key: \"setLineWidth\",\n    value: function setLineWidth(width) {\n      this._out(width, \" w\", NL);\n    }\n  }, {\n    key: \"setLineCap\",\n    value: function setLineCap(lineCap) {\n      this._out(lineCap, \" J\", NL);\n    }\n  }, {\n    key: \"setLineJoin\",\n    value: function setLineJoin(lineJoin) {\n      this._out(lineJoin, \" j\", NL);\n    }\n  }, {\n    key: \"setMitterLimit\",\n    value: function setMitterLimit(mitterLimit) {\n      this._out(mitterLimit, \" M\", NL);\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      this._contextStack.push(this._context());\n\n      this._out(\"q\", NL);\n    }\n  }, {\n    key: \"restore\",\n    value: function restore() {\n      this._out(\"Q\", NL);\n\n      this._context(this._contextStack.pop());\n    } // paths\n\n  }, {\n    key: \"moveTo\",\n    value: function moveTo(x, y) {\n      this._out(x, \" \", y, \" m\", NL);\n    }\n  }, {\n    key: \"lineTo\",\n    value: function lineTo(x, y) {\n      this._out(x, \" \", y, \" l\", NL);\n    }\n  }, {\n    key: \"bezier\",\n    value: function bezier(x1, y1, x2, y2, x3, y3) {\n      this._out(x1, \" \", y1, \" \", x2, \" \", y2, \" \", x3, \" \", y3, \" c\", NL);\n    }\n  }, {\n    key: \"bezier1\",\n    value: function bezier1(x1, y1, x3, y3) {\n      this._out(x1, \" \", y1, \" \", x3, \" \", y3, \" y\", NL);\n    }\n  }, {\n    key: \"bezier2\",\n    value: function bezier2(x2, y2, x3, y3) {\n      this._out(x2, \" \", y2, \" \", x3, \" \", y3, \" v\", NL);\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this._out(\"h\", NL);\n    }\n  }, {\n    key: \"rect\",\n    value: function rect(x, y, w, h) {\n      this._out(x, \" \", y, \" \", w, \" \", h, \" re\", NL);\n    }\n  }, {\n    key: \"ellipse\",\n    value: function ellipse(x, y, rx, ry) {\n      function _X(v) {\n        return x + v;\n      }\n\n      function _Y(v) {\n        return y + v;\n      } // how to get to the \"magic number\" is explained here:\n      // http://www.whizkidtech.redprince.net/bezier/circle/kappa/\n\n\n      var k = 0.5522847498307936;\n      this.moveTo(_X(0), _Y(ry));\n      this.bezier(_X(rx * k), _Y(ry), _X(rx), _Y(ry * k), _X(rx), _Y(0));\n      this.bezier(_X(rx), _Y(-ry * k), _X(rx * k), _Y(-ry), _X(0), _Y(-ry));\n      this.bezier(_X(-rx * k), _Y(-ry), _X(-rx), _Y(-ry * k), _X(-rx), _Y(0));\n      this.bezier(_X(-rx), _Y(ry * k), _X(-rx * k), _Y(ry), _X(0), _Y(ry));\n    }\n  }, {\n    key: \"circle\",\n    value: function circle(x, y, r) {\n      this.ellipse(x, y, r, r);\n    }\n  }, {\n    key: \"stroke\",\n    value: function stroke() {\n      this._out(\"S\", NL);\n    }\n  }, {\n    key: \"nop\",\n    value: function nop() {\n      this._out(\"n\", NL);\n    }\n  }, {\n    key: \"clip\",\n    value: function clip() {\n      this._out(\"W n\", NL);\n    }\n  }, {\n    key: \"clipStroke\",\n    value: function clipStroke() {\n      this._out(\"W S\", NL);\n    }\n  }, {\n    key: \"closeStroke\",\n    value: function closeStroke() {\n      this._out(\"s\", NL);\n    }\n  }, {\n    key: \"fill\",\n    value: function fill() {\n      this._out(\"f\", NL);\n    }\n  }, {\n    key: \"fillStroke\",\n    value: function fillStroke() {\n      this._out(\"B\", NL);\n    }\n  }, {\n    key: \"drawImage\",\n    value: function drawImage(url) {\n      var img = this._pdf.getImage(url);\n\n      if (img) {\n        // the result can be null for a cross-domain image\n        this._xResources[img._resourceName] = img;\n\n        this._out(img._resourceName, \" Do\", NL);\n      }\n    }\n  }, {\n    key: \"comment\",\n    value: function comment(txt) {\n      var self = this;\n      txt.split(/\\r?\\n/g).forEach(function (line) {\n        self._out(\"% \", line, NL);\n      });\n    } // internal\n\n  }, {\n    key: \"_context\",\n    value: function _context(val) {\n      if (val != null) {\n        this._opacity = val.opacity;\n        this._matrix = val.matrix;\n      } else {\n        return {\n          opacity: this._opacity,\n          matrix: this._matrix\n        };\n      }\n    }\n  }, {\n    key: \"_toPage\",\n    value: function _toPage(p) {\n      var m = this._matrix;\n      var a = m[0],\n          b = m[1],\n          c = m[2],\n          d = m[3],\n          e = m[4],\n          f = m[5];\n      return {\n        x: a * p.x + c * p.y + e,\n        y: b * p.x + d * p.y + f\n      };\n    }\n  }]);\n\n  return PDFPage;\n}(PDFDictionary);\n\nfunction unquote(str) {\n  return str.replace(/^\\s*(['\"])(.*)\\1\\s*$/, \"$2\");\n}\n\nfunction parseFontDef(fontdef) {\n  // XXX: this is very crude for now and buggy.  Proper parsing is quite involved.\n  var rx = /^\\s*((normal|italic)\\s+)?((normal|small-caps)\\s+)?((normal|bold|\\d+)\\s+)?(([0-9.]+)(px|pt))(\\/(([0-9.]+)(px|pt)|normal))?\\s+(.*?)\\s*$/i;\n  var m = rx.exec(fontdef);\n\n  if (!m) {\n    return {\n      fontSize: 12,\n      fontFamily: \"sans-serif\"\n    };\n  }\n\n  var fontSize = m[8] ? parseInt(m[8], 10) : 12;\n  return {\n    italic: m[2] && m[2].toLowerCase() == \"italic\",\n    variant: m[4],\n    bold: m[6] && /bold|700/i.test(m[6]),\n    fontSize: fontSize,\n    lineHeight: m[12] ? m[12] == \"normal\" ? fontSize : parseInt(m[12], 10) : null,\n    fontFamily: m[14].split(/\\s*,\\s*/g).map(unquote)\n  };\n}\n\nfunction getFontURL(style) {\n  function mkFamily(name) {\n    if (style.bold) {\n      name += \"|bold\";\n    }\n\n    if (style.italic) {\n      name += \"|italic\";\n    }\n\n    return name.toLowerCase();\n  }\n\n  var fontFamily = style.fontFamily;\n  var name, url;\n\n  if (fontFamily instanceof Array) {\n    for (var i = 0; i < fontFamily.length; ++i) {\n      name = mkFamily(fontFamily[i]);\n      url = FONT_MAPPINGS[name];\n\n      if (url) {\n        break;\n      }\n    }\n  } else {\n    url = FONT_MAPPINGS[fontFamily.toLowerCase()];\n  }\n\n  while (typeof url == \"function\") {\n    url = url();\n  }\n\n  if (!url) {\n    url = \"Times-Roman\";\n  }\n\n  return url;\n}\n\nvar FONT_MAPPINGS = {\n  \"serif\": \"Times-Roman\",\n  \"serif|bold\": \"Times-Bold\",\n  \"serif|italic\": \"Times-Italic\",\n  \"serif|bold|italic\": \"Times-BoldItalic\",\n  \"sans-serif\": \"Helvetica\",\n  \"sans-serif|bold\": \"Helvetica-Bold\",\n  \"sans-serif|italic\": \"Helvetica-Oblique\",\n  \"sans-serif|bold|italic\": \"Helvetica-BoldOblique\",\n  \"monospace\": \"Courier\",\n  \"monospace|bold\": \"Courier-Bold\",\n  \"monospace|italic\": \"Courier-Oblique\",\n  \"monospace|bold|italic\": \"Courier-BoldOblique\",\n  \"zapfdingbats\": \"ZapfDingbats\",\n  \"zapfdingbats|bold\": \"ZapfDingbats\",\n  \"zapfdingbats|italic\": \"ZapfDingbats\",\n  \"zapfdingbats|bold|italic\": \"ZapfDingbats\"\n};\n\nfunction fontAlias(alias, name) {\n  alias = alias.toLowerCase();\n\n  FONT_MAPPINGS[alias] = function () {\n    return FONT_MAPPINGS[name];\n  };\n\n  FONT_MAPPINGS[alias + \"|bold\"] = function () {\n    return FONT_MAPPINGS[name + \"|bold\"];\n  };\n\n  FONT_MAPPINGS[alias + \"|italic\"] = function () {\n    return FONT_MAPPINGS[name + \"|italic\"];\n  };\n\n  FONT_MAPPINGS[alias + \"|bold|italic\"] = function () {\n    return FONT_MAPPINGS[name + \"|bold|italic\"];\n  };\n} // Let's define some common names to an appropriate replacement.\n// These are overridable via pdf.defineFont, should the user want to\n// include the proper versions.\n\n\nfontAlias(\"Times New Roman\", \"serif\");\nfontAlias(\"Courier New\", \"monospace\");\nfontAlias(\"Arial\", \"sans-serif\");\nfontAlias(\"Helvetica\", \"sans-serif\");\nfontAlias(\"Verdana\", \"sans-serif\");\nfontAlias(\"Tahoma\", \"sans-serif\");\nfontAlias(\"Georgia\", \"sans-serif\");\nfontAlias(\"Monaco\", \"monospace\");\nfontAlias(\"Andale Mono\", \"monospace\");\n\nfunction defineFont(name, url) {\n  if (arguments.length == 1) {\n    for (var i in name) {\n      if (hasOwnProperty(name, i)) {\n        defineFont(i, name[i]);\n      }\n    }\n  } else {\n    name = name.toLowerCase();\n    FONT_MAPPINGS[name] = url; // special handling for DejaVu fonts: if they get defined,\n    // let them also replace the default families, for good\n    // Unicode support out of the box.\n\n    switch (name) {\n      case \"dejavu sans\":\n        FONT_MAPPINGS[\"sans-serif\"] = url;\n        break;\n\n      case \"dejavu sans|bold\":\n        FONT_MAPPINGS[\"sans-serif|bold\"] = url;\n        break;\n\n      case \"dejavu sans|italic\":\n        FONT_MAPPINGS[\"sans-serif|italic\"] = url;\n        break;\n\n      case \"dejavu sans|bold|italic\":\n        FONT_MAPPINGS[\"sans-serif|bold|italic\"] = url;\n        break;\n\n      case \"dejavu serif\":\n        FONT_MAPPINGS[\"serif\"] = url;\n        break;\n\n      case \"dejavu serif|bold\":\n        FONT_MAPPINGS[\"serif|bold\"] = url;\n        break;\n\n      case \"dejavu serif|italic\":\n        FONT_MAPPINGS[\"serif|italic\"] = url;\n        break;\n\n      case \"dejavu serif|bold|italic\":\n        FONT_MAPPINGS[\"serif|bold|italic\"] = url;\n        break;\n\n      case \"dejavu mono\":\n        FONT_MAPPINGS[\"monospace\"] = url;\n        break;\n\n      case \"dejavu mono|bold\":\n        FONT_MAPPINGS[\"monospace|bold\"] = url;\n        break;\n\n      case \"dejavu mono|italic\":\n        FONT_MAPPINGS[\"monospace|italic\"] = url;\n        break;\n\n      case \"dejavu mono|bold|italic\":\n        FONT_MAPPINGS[\"monospace|bold|italic\"] = url;\n        break;\n    }\n  }\n}\n\nfunction mmul(a, b) {\n  var a1 = a[0],\n      b1 = a[1],\n      c1 = a[2],\n      d1 = a[3],\n      e1 = a[4],\n      f1 = a[5];\n  var a2 = b[0],\n      b2 = b[1],\n      c2 = b[2],\n      d2 = b[3],\n      e2 = b[4],\n      f2 = b[5];\n  return [a1 * a2 + b1 * c2, a1 * b2 + b1 * d2, c1 * a2 + d1 * c2, c1 * b2 + d1 * d2, e1 * a2 + f1 * c2 + e2, e1 * b2 + f1 * d2 + f2];\n}\n\nfunction isIdentityMatrix(m) {\n  return m[0] === 1 && m[1] === 0 && m[2] === 0 && m[3] === 1 && m[4] === 0 && m[5] === 0;\n}\n\nvar TEXT_RENDERING_MODE = {\n  fill: 0,\n  stroke: 1,\n  fillAndStroke: 2,\n  invisible: 3,\n  fillAndClip: 4,\n  strokeAndClip: 5,\n  fillStrokeClip: 6,\n  clip: 7\n};\nexport { PDFDocument as Document, BinaryStream, defineFont, parseFontDef, getFontURL, loadFonts, loadImages, getPaperOptions, clearImageCache, TEXT_RENDERING_MODE };","map":{"version":3,"sources":["/home/datquocngo/Project/Hung/gts-fe/node_modules/@progress/kendo-drawing/dist/es2015/pdf/core.js"],"names":["BinaryStream","ucs2encode","base64ToUint8Array","HAS_TYPED_ARRAYS","support","TTFFont","deflate","supportsDeflate","encodeUTF16BE","BOM","browser","NL","RESOURCE_COUNTER","PAPER_SIZE","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","a10","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","c10","executive","folio","legal","letter","tabloid","makeOutput","indentLevel","output","out","i","arguments","length","x","undefined","Error","PDFValue","beforeRender","render","isArray","renderArray","isDate","renderDate","isNaN","num","toFixed","indexOf","replace","writeString","test","String","get","write","PDFDictionary","writeData","data","withIndent","f","indent","pad","apply","offset","toString","stream","wrapObject","value","id","renderValue","renderFull","_offset","call","getPaperOptions","getOption","options","key","def","paperSize","toLowerCase","unitsToPoints","Math","max","min","margin","left","top","right","bottom","FONT_CACHE","loadBinary","url","cont","m","msie","exec","substr","error","window","console","log","req","XMLHttpRequest","open","responseType","onload","status","Uint8Array","response","VBArray","responseBody","toArray","onerror","send","loadFont","font","IMAGE_CACHE","clearImageCache","loadImage","size","img","bloburl","blob","Image","crossOrigin","xhr","URL","createObjectURL","_load","_onerror","src","complete","_onload","_trycanvas","width","height","canvas","document","createElement","ctx","getContext","drawImage","imgdata","getImageData","ex","revokeObjectURL","hasAlpha","rgb","alpha","rawbytes","writeByte","a","keepPNG","PDFRawImage","toDataURL","jpegQuality","writeBase64","PDFJpegImage","type","reader","FileReader","result","readAsArrayBuffer","manyLoader","loadOne","urls","callback","n","next","loadFonts","loadImages","images","Object","assign","keys","forEach","PDFDocument","self","objcount","objects","name","defval","attach","push","pages","FONTS","IMAGES","GRAD_COL_FUNCTIONS","GRAD_OPC_FUNCTIONS","GRAD_COL","GRAD_OPC","catalog","PDFCatalog","pageTree","PDFPageTree","nameTree","JavaScript","Names","PDFString","S","_","JS","props","setPages","info","Producer","Title","Author","Subject","Keywords","Creator","CreationDate","Date","addPage","paperOptions","contentWidth","contentHeight","content","PDFStream","Contents","Parent","MediaBox","page","PDFPage","_content","transform","translate","rect","clip","xrefOffset","zeropad","Size","Root","Info","PDFStandardFont","PDFFont","asStream","opacity","forStroke","parseFloat","cache","_opacityGSCache","gs","Type","CA","ca","_resourceName","str","len","ch","hasOwnProperty","obj","prototype","Array","date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","mm2pt","mm","cm2pt","cm","in2pt","inch","utf16be","Boolean","txt","code","charCodeAt","PDFHexString","PDFName","escape","c","PDFName_cache","empty","compress","tmp","Filter","unshift","Length","pagesObj","Pages","Kids","Count","pageObj","SOF_CODES","colorSpace","bitsPerComponent","soi","readShort","eof","ff","readByte","marker","skip","Subtype","Width","Height","BitsPerComponent","ColorSpace","Decode","pdf","mask","SMask","BaseFont","Encoding","_pdf","_font","_sub","makeSubset","head","psName","scale","bbox","xMin","yMin","xMax","yMax","italicAngle","post","ascent","descent","lineGap","capHeight","os2","xHeight","stemV","familyClass","isSerif","isScript","flags","isFixedPitch","text","encodeText","fontSize","codeMap","cmap","glyphId","widthOfGlyph","sub","fontStream","Length1","descriptor","FontName","FontBBox","Flags","StemV","ItalicAngle","Ascent","Descent","CapHeight","XHeight","FontFile2","ncid2ogid","firstChar","lastChar","charWidths","loop","chunk","gid","descendant","CIDSystemInfo","Registry","Ordering","Supplement","FontDescriptor","FirstChar","LastChar","DW","round","W","CIDToGIDMap","_makeCidToGidMap","dict","DescendantFonts","unimap","PDFToUnicodeCmap","subset","unimapStream","ToUnicode","cidToGidMap","map","unicode","makeHash","join","cacheColorGradientFunction","r1","g1","r2","g2","hash","func","FunctionType","Domain","Range","N","C0","C1","cacheOpacityGradientFunction","makeGradientFunctions","stops","opacities","colors","offsets","encode","prev","cur","prevColor","curColor","color","r","g","b","pop","assemble","funcs","Functions","Bounds","Encode","cacheColorGradient","isRadial","coords","box","shading","concat","ShadingType","Coords","Function","Extend","cacheOpacityGradient","AIS","G","FormType","BBox","Group","CS","I","Resources","ExtGState","Shading","s0","cacheGradient","gradient","start","y","end","userSpace","_rcount","_textMode","_fontResources","_gsResources","_xResources","_patResources","_shResources","_opacity","_matrix","_annotations","_fontSize","_contextStack","ProcSet","Font","XObject","Pattern","Annots","d","e","isIdentityMatrix","mmul","_out","dx","dy","sx","sy","angle","cos","sin","_requireTextMode","getFont","mode","requestedWidth","_requireFont","outputWidth","getTextWidth","uri","ll","_toPage","ur","Rect","Border","A","URI","setFillOpacity","setStrokeOpacity","getOpacityGS","save","sname","oname","restore","dashArray","dashPhase","lineCap","lineJoin","mitterLimit","_context","x1","y1","x2","y2","x3","y3","w","h","rx","ry","_X","v","_Y","k","moveTo","bezier","ellipse","getImage","split","line","val","matrix","p","unquote","parseFontDef","fontdef","fontFamily","parseInt","italic","variant","bold","lineHeight","getFontURL","style","mkFamily","FONT_MAPPINGS","fontAlias","alias","defineFont","d1","e1","f1","d2","e2","f2","TEXT_RENDERING_MODE","fill","stroke","fillAndStroke","invisible","fillAndClip","strokeAndClip","fillStrokeClip","Document"],"mappings":"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","sourcesContent":["/* eslint-disable no-multi-spaces, key-spacing, indent, camelcase, space-before-blocks, eqeqeq, brace-style */\n/* eslint-disable space-infix-ops, space-before-function-paren, array-bracket-spacing, object-curly-spacing */\n/* eslint-disable no-nested-ternary, max-params, default-case, no-else-return, no-empty */\n/* eslint-disable no-param-reassign, no-var, block-scoped-var */\n\nimport { BinaryStream, ucs2encode, base64ToUint8Array, HAS_TYPED_ARRAYS } from \"./utils\";\nimport { support } from '../common';\nimport { TTFFont } from \"./ttf\";\nimport { deflate, supportsDeflate } from './deflate';\nimport { encodeUTF16BE, BOM } from \"../util/encode-utf\";\n\nconst browser = support.browser;\nconst NL = \"\\n\";\n\nvar RESOURCE_COUNTER = 0;\n\nconst PAPER_SIZE = {\n    a0        : [ 2383.94 , 3370.39 ],\n    a1        : [ 1683.78 , 2383.94 ],\n    a2        : [ 1190.55 , 1683.78 ],\n    a3        : [ 841.89  , 1190.55 ],\n    a4        : [ 595.28  , 841.89  ],\n    a5        : [ 419.53  , 595.28  ],\n    a6        : [ 297.64  , 419.53  ],\n    a7        : [ 209.76  , 297.64  ],\n    a8        : [ 147.40  , 209.76  ],\n    a9        : [ 104.88  , 147.40  ],\n    a10       : [ 73.70   , 104.88  ],\n    b0        : [ 2834.65 , 4008.19 ],\n    b1        : [ 2004.09 , 2834.65 ],\n    b2        : [ 1417.32 , 2004.09 ],\n    b3        : [ 1000.63 , 1417.32 ],\n    b4        : [ 708.66  , 1000.63 ],\n    b5        : [ 498.90  , 708.66  ],\n    b6        : [ 354.33  , 498.90  ],\n    b7        : [ 249.45  , 354.33  ],\n    b8        : [ 175.75  , 249.45  ],\n    b9        : [ 124.72  , 175.75  ],\n    b10       : [ 87.87   , 124.72  ],\n    c0        : [ 2599.37 , 3676.54 ],\n    c1        : [ 1836.85 , 2599.37 ],\n    c2        : [ 1298.27 , 1836.85 ],\n    c3        : [ 918.43  , 1298.27 ],\n    c4        : [ 649.13  , 918.43  ],\n    c5        : [ 459.21  , 649.13  ],\n    c6        : [ 323.15  , 459.21  ],\n    c7        : [ 229.61  , 323.15  ],\n    c8        : [ 161.57  , 229.61  ],\n    c9        : [ 113.39  , 161.57  ],\n    c10       : [ 79.37   , 113.39  ],\n    executive : [ 521.86  , 756.00  ],\n    folio     : [ 612.00  , 936.00  ],\n    legal     : [ 612.00  , 1008.00 ],\n    letter    : [ 612.00  , 792.00  ],\n    tabloid   : [ 792.00  , 1224.00 ]\n};\n\nfunction makeOutput() {\n    var indentLevel = 0, output = BinaryStream();\n    function out() {\n        for (var i = 0; i < arguments.length; ++i) {\n            var x = arguments[i];\n            if (x === undefined) {\n                throw new Error(\"Cannot output undefined to PDF\");\n            }\n            else if (x instanceof PDFValue) {\n                x.beforeRender(out);\n                x.render(out);\n            }\n            else if (isArray(x)) {\n                renderArray(x, out);\n            }\n            else if (isDate(x)) {\n                renderDate(x, out);\n            }\n            else if (typeof x == \"number\") {\n                if (isNaN(x)) {\n                    throw new Error(\"Cannot output NaN to PDF\");\n                }\n                // make sure it doesn't end up in exponent notation\n                var num = x.toFixed(7);\n                if (num.indexOf(\".\") >= 0) {\n                    num = num.replace(/\\.?0+$/, \"\");\n                }\n                if (num == \"-0\") {\n                    num = \"0\";\n                }\n                output.writeString(num);\n            }\n            else if (/string|boolean/.test(typeof x)) {\n                output.writeString(String(x));\n            }\n            else if (typeof x.get == \"function\") {\n                output.write(x.get());\n            }\n            else if (typeof x == \"object\") {\n                if (!x) {\n                    output.writeString(\"null\");\n                } else {\n                    out(new PDFDictionary(x));\n                }\n            }\n        }\n    }\n    out.writeData = function(data) {\n        output.write(data);\n    };\n    out.withIndent = function(f) {\n        ++indentLevel;\n        f(out);\n        --indentLevel;\n    };\n    out.indent = function() {\n        out(NL, pad(\"\", indentLevel * 2, \"  \"));\n        out.apply(null, arguments);\n    };\n    out.offset = function() {\n        return output.offset();\n    };\n    out.toString = function() {\n        throw new Error(\"FIX CALLER\");\n    };\n    out.get = function() {\n        return output.get();\n    };\n    out.stream = function() {\n        return output;\n    };\n    return out;\n}\n\nfunction wrapObject(value, id) {\n    var beforeRender = value.beforeRender;\n    var renderValue = value.render;\n\n    value.beforeRender = function(){};\n\n    value.render = function(out) {\n        out(id, \" 0 R\");\n    };\n\n    value.renderFull = function(out) {\n        value._offset = out.offset();\n        out(id, \" 0 obj \");\n        beforeRender.call(value, out);\n        renderValue.call(value, out);\n        out(\" endobj\");\n    };\n}\n\nfunction getPaperOptions(getOption) {\n    if (typeof getOption != \"function\") {\n        var options = getOption;\n        getOption = function(key, def) {\n            return key in options ? options[key] : def;\n        };\n    }\n    var paperSize = getOption(\"paperSize\", PAPER_SIZE.a4);\n    if (!paperSize) {\n        return {};\n    }\n    if (typeof paperSize == \"string\") {\n        paperSize = PAPER_SIZE[paperSize.toLowerCase()];\n        if (paperSize == null) {\n            throw new Error(\"Unknown paper size\");\n        }\n    }\n\n    paperSize[0] = unitsToPoints(paperSize[0]);\n    paperSize[1] = unitsToPoints(paperSize[1]);\n\n    if (getOption(\"landscape\", false)) {\n        paperSize = [\n            Math.max(paperSize[0], paperSize[1]),\n            Math.min(paperSize[0], paperSize[1])\n        ];\n    }\n\n    var margin = getOption(\"margin\");\n    if (margin) {\n        if (typeof margin == \"string\" || typeof margin == \"number\") {\n            margin = unitsToPoints(margin, 0);\n            margin = { left: margin, top: margin, right: margin, bottom: margin };\n        } else {\n            margin = {\n                left   : unitsToPoints(margin.left, 0),\n                top    : unitsToPoints(margin.top, 0),\n                right  : unitsToPoints(margin.right, 0),\n                bottom : unitsToPoints(margin.bottom, 0)\n            };\n        }\n        if (getOption(\"addMargin\")) {\n            paperSize[0] += margin.left + margin.right;\n            paperSize[1] += margin.top + margin.bottom;\n        }\n    }\n    return { paperSize: paperSize, margin: margin };\n}\n\nvar FONT_CACHE = {\n    \"Times-Roman\"           : true,\n    \"Times-Bold\"            : true,\n    \"Times-Italic\"          : true,\n    \"Times-BoldItalic\"      : true,\n    \"Helvetica\"             : true,\n    \"Helvetica-Bold\"        : true,\n    \"Helvetica-Oblique\"     : true,\n    \"Helvetica-BoldOblique\" : true,\n    \"Courier\"               : true,\n    \"Courier-Bold\"          : true,\n    \"Courier-Oblique\"       : true,\n    \"Courier-BoldOblique\"   : true,\n    \"Symbol\"                : true,\n    \"ZapfDingbats\"          : true\n};\n\nfunction loadBinary(url, cont) {\n    // IE throws Accesss denied error for Data URIs\n    let m;\n    if (browser.msie && (m = /^data:.*?;base64,/i.exec(url))) {\n        cont(base64ToUint8Array(url.substr(m[0].length)));\n        return;\n    }\n\n    function error() {\n        if (window.console) {\n            if (window.console.error) {\n                window.console.error(\"Cannot load URL: %s\", url);\n            } else {\n                window.console.log(\"Cannot load URL: %s\", url);\n            }\n        }\n        cont(null);\n    }\n    var req = new XMLHttpRequest();\n    req.open('GET', url, true);\n    if (HAS_TYPED_ARRAYS) {\n        req.responseType = \"arraybuffer\";\n    }\n    req.onload = function() {\n        if (req.status == 200 || req.status == 304) {\n            if (HAS_TYPED_ARRAYS) {\n                cont(new Uint8Array(req.response));\n            } else {\n                cont(new window.VBArray(req.responseBody).toArray()); // IE9 only\n            }\n        } else {\n            error();\n        }\n    };\n    req.onerror = error;\n    req.send(null);\n}\n\nfunction loadFont(url, cont) {\n    var font = FONT_CACHE[url];\n    if (font) {\n        cont(font);\n    } else {\n        loadBinary(url, function(data){\n            if (data == null) {\n                throw new Error(\"Cannot load font from \" + url);\n            } else {\n                var font = new TTFFont(data);\n                FONT_CACHE[url] = font;\n                cont(font);\n            }\n        });\n    }\n}\n\nvar IMAGE_CACHE = {};\n\nfunction clearImageCache() {\n    IMAGE_CACHE = {};\n}\n\nfunction loadImage(url, size, cont, options) {\n    var img = IMAGE_CACHE[url], bloburl, blob;\n    if (img) {\n        cont(img);\n    } else {\n        img = new Image();\n        if (!(/^data:/i.test(url))) {\n            img.crossOrigin = \"Anonymous\";\n        }\n        if (HAS_TYPED_ARRAYS && !(/^data:/i.test(url))) {\n            // IE10 fails to load images from another domain even when the server sends the\n            // proper CORS headers.  a XHR, however, will be able to load the data.\n            // http://stackoverflow.com/a/19734516/154985\n            //\n            // On the other hand, it's worth doing it this way for all browsers which support\n            // responseType = \"blob\" (HAS_TYPED_ARRAYS will be true), because we can inspect the\n            // mime type and if it's a JPEG (very common case) we can save a lot of time in\n            // _load below.\n            var xhr = new XMLHttpRequest();\n            xhr.onload = function() {\n                blob = xhr.response;\n                bloburl = URL.createObjectURL(blob);\n                _load(bloburl);\n            };\n            xhr.onerror = _onerror;\n            xhr.open(\"GET\", url, true);\n            xhr.responseType = \"blob\";\n            xhr.send();\n        } else {\n            _load(url);\n        }\n    }\n\n    function _load(url) {\n        img.src = url;\n        if (img.complete && !browser.msie) {\n            // IE, bless it's little heart, says img.complete == true even though the image is\n            // not loaded (width=0), therefore we must go the onload route (ticket 929635).\n            _onload();\n        } else {\n            img.onload = _onload;\n            img.onerror = _onerror;\n        }\n    }\n\n    function _trycanvas() {\n        if (!size) {\n            size = { width: img.width, height: img.height };\n        }\n\n        var canvas = document.createElement(\"canvas\");\n        canvas.width = size.width;\n        canvas.height = size.height;\n\n        var ctx = canvas.getContext(\"2d\");\n        ctx.drawImage(img, 0, 0, size.width, size.height);\n\n        var imgdata;\n        try {\n            imgdata = ctx.getImageData(0, 0, size.width, size.height);\n        } catch (ex) {\n            // it tainted the canvas -- can't draw it.\n            _onerror();\n            return;\n        } finally {\n            if (bloburl) {\n                URL.revokeObjectURL(bloburl);\n            }\n        }\n\n        // in case it contains transparency, we must separate rgb data from the alpha\n        // channel and create a PDFRawImage image with opacity.  otherwise we can use a\n        // PDFJpegImage.\n        //\n        // to do this in one step, we create the rgb and alpha streams anyway, even if\n        // we might end up not using them if hasAlpha remains false.\n\n        var hasAlpha = false, rgb = BinaryStream(), alpha = BinaryStream();\n        var rawbytes = imgdata.data;\n        var i = 0;\n        while (i < rawbytes.length) {\n            rgb.writeByte(rawbytes[i++]);\n            rgb.writeByte(rawbytes[i++]);\n            rgb.writeByte(rawbytes[i++]);\n            var a = rawbytes[i++];\n            if (a < 255) {\n                hasAlpha = true;\n            }\n            alpha.writeByte(a);\n        }\n\n        if (hasAlpha || options.keepPNG) {\n            img = new PDFRawImage(size.width, size.height, rgb, alpha);\n        } else {\n            // no transparency, encode as JPEG.\n            var data = canvas.toDataURL(\"image/jpeg\", options.jpegQuality);\n            data = data.substr(data.indexOf(\";base64,\") + 8);\n\n            var stream = BinaryStream();\n            stream.writeBase64(data);\n            img = new PDFJpegImage(stream);\n        }\n\n        cont(IMAGE_CACHE[url] = img);\n    }\n\n    function _onerror() {\n        cont(IMAGE_CACHE[url] = \"ERROR\");\n    }\n\n    function _onload() {\n        if (size) {\n            // but if requested size is bigger than the image, just use the original image.\n            if (size.width >= img.width || size.height >= img.height) {\n                size = null;\n            }\n        }\n        if (!size && blob && /^image\\/jpe?g$/i.test(blob.type)) {\n            // If we know we got a JPEG, we can skip the process of rendering it to a\n            // canvas, getting the pixel data, searching for transparency we know we won't\n            // find, getting back a data URI and then decoding the BASE64 to finally get the\n            // binary we already have.  Also, we avoid downgrading the image quality, with\n            // the possible drawback of making a bigger PDF; still, seems legit.\n            //\n            // Besides saving a lot of work, this also reuses the buffer memory\n            // (BinaryStream does not create a copy), potentially saving some GC cycles.\n            let reader = new FileReader();\n            reader.onload = function() {\n                try {\n                    let img = new PDFJpegImage(BinaryStream(new Uint8Array(this.result)));\n                    URL.revokeObjectURL(bloburl);\n                    cont(IMAGE_CACHE[url] = img);\n                } catch (ex) {\n                    // if there's an error parsing the JPEG stream, it could be due to a\n                    // misconfigured server (improper content-type:\n                    // https://github.com/telerik/kendo-ui-core/issues/4184).  If that's the case,\n                    // the canvas will still be able to draw it.\n                    _trycanvas();\n                }\n            };\n            reader.readAsArrayBuffer(blob);\n        } else {\n            _trycanvas();\n        }\n    }\n}\n\nfunction manyLoader(loadOne) {\n    return function(urls, callback) {\n        var n = urls.length, i = n;\n        if (n === 0) {\n            return callback();\n        }\n        function next() {\n            if (--n === 0) {\n                callback();\n            }\n        }\n        while (i-- > 0) {\n            loadOne(urls[i], next);\n        }\n    };\n}\n\nvar loadFonts = manyLoader(loadFont);\nvar loadImages = function(images, callback, options) {\n    options = Object.assign({\n        jpegQuality : 0.92,\n        keepPNG     : false\n    }, options);\n    var urls = Object.keys(images), n = urls.length;\n    if (n === 0) {\n        return callback();\n    }\n    function next() {\n        if (--n === 0) {\n            callback();\n        }\n    }\n    urls.forEach(function(url){\n        loadImage(url, images[url], next, options);\n    });\n};\n\nclass PDFDocument {\n    constructor (options) {\n        var self = this;\n        var out = makeOutput();\n        var objcount = 0;\n        var objects = [];\n\n        function getOption(name, defval) {\n            return (options && options[name] != null) ? options[name] : defval;\n        }\n\n        self.getOption = getOption;\n\n        self.attach = function(value) {\n            if (objects.indexOf(value) < 0) {\n                wrapObject(value, ++objcount);\n                objects.push(value);\n            }\n            return value;\n        };\n\n        self.pages = [];\n\n        self.FONTS = {};\n        self.IMAGES = {};\n        self.GRAD_COL_FUNCTIONS = {}; // cache for color gradient functions\n        self.GRAD_OPC_FUNCTIONS = {}; // cache for opacity gradient functions\n        self.GRAD_COL = {};     // cache for whole color gradient objects\n        self.GRAD_OPC = {};     // cache for whole opacity gradient objects\n\n        var catalog = self.attach(new PDFCatalog());\n        var pageTree = self.attach(new PDFPageTree());\n\n        if (getOption(\"autoPrint\")) {\n            let nameTree = {};\n            nameTree.JavaScript = new PDFDictionary({ Names: [\n                new PDFString(\"JS\"), self.attach(new PDFDictionary({\n                    S: _(\"JavaScript\"),\n                    JS: new PDFString(\"print(true);\")\n                }))\n            ] });\n            catalog.props.Names = new PDFDictionary(nameTree);\n        }\n\n        catalog.setPages(pageTree);\n\n        var info = self.attach(new PDFDictionary({\n            Producer     : new PDFString(getOption(\"producer\", \"Kendo UI PDF Generator\"), true), // XXX: kendo.version?\n            Title        : new PDFString(getOption(\"title\", \"\"), true),\n            Author       : new PDFString(getOption(\"author\", \"\"), true),\n            Subject      : new PDFString(getOption(\"subject\", \"\"), true),\n            Keywords     : new PDFString(getOption(\"keywords\", \"\"), true),\n            Creator      : new PDFString(getOption(\"creator\", \"Kendo UI PDF Generator\"), true),\n            CreationDate : getOption(\"date\", new Date())\n        }));\n\n        self.addPage = function(options) {\n            var paperOptions  = getPaperOptions(function(name, defval){\n                return (options && options[name] != null) ? options[name] : defval;\n            });\n            var paperSize     = paperOptions.paperSize;\n            var margin        = paperOptions.margin;\n            var contentWidth  = paperSize[0];\n            var contentHeight = paperSize[1];\n            if (margin) {\n                contentWidth -= margin.left + margin.right;\n                contentHeight -= margin.top + margin.bottom;\n            }\n            var content = new PDFStream(makeOutput(), null, true);\n            var props = {\n                Contents : self.attach(content),\n                Parent   : pageTree,\n                MediaBox : [ 0, 0, paperSize[0], paperSize[1] ]\n            };\n            var page = new PDFPage(self, props);\n            page._content = content;\n            pageTree.addPage(self.attach(page));\n\n            // canvas-like coord. system.  (0,0) is upper-left.\n            // text must be vertically mirorred before drawing.\n            page.transform(1, 0, 0, -1, 0, paperSize[1]);\n\n            if (margin) {\n                page.translate(margin.left, margin.top);\n                // XXX: clip to right/bottom margin.  Make this optional?\n                page.rect(0, 0, contentWidth, contentHeight);\n                page.clip();\n            }\n\n            self.pages.push(page);\n            return page;\n        };\n\n        self.render = function() {\n            var i;\n            /// file header\n            out(\"%PDF-1.4\", NL, \"%\\xc2\\xc1\\xda\\xcf\\xce\", NL, NL);\n\n            /// file body\n            for (i = 0; i < objects.length; ++i) {\n                objects[i].renderFull(out);\n                out(NL, NL);\n            }\n\n            /// cross-reference table\n            var xrefOffset = out.offset();\n            out(\"xref\", NL, 0, \" \", objects.length + 1, NL);\n            out(\"0000000000 65535 f \", NL);\n            for (i = 0; i < objects.length; ++i) {\n                out(zeropad(objects[i]._offset, 10), \" 00000 n \", NL);\n            }\n            out(NL);\n\n            /// trailer\n            out(\"trailer\", NL);\n            out(new PDFDictionary({\n                Size: objects.length + 1,\n                Root: catalog,\n                Info: info\n            }), NL, NL);\n\n            /// end\n            out(\"startxref\", NL, xrefOffset, NL);\n            out(\"%%EOF\", NL);\n\n            return out.stream().offset(0);\n        };\n\n        self.loadFonts = loadFonts;\n        self.loadImages = loadImages;\n    }\n\n    getFont(url) {\n        var font = this.FONTS[url];\n        if (!font) {\n            font = FONT_CACHE[url];\n            if (!font) {\n                throw new Error(\"Font \" + url + \" has not been loaded\");\n            }\n            if (font === true) {\n                font = this.attach(new PDFStandardFont(url));\n            } else {\n                font = this.attach(new PDFFont(this, font));\n            }\n            this.FONTS[url] = font;\n        }\n        return font;\n    }\n\n    getImage(url) {\n        var img = this.IMAGES[url];\n        if (!img) {\n            img = IMAGE_CACHE[url];\n            if (!img) {\n                throw new Error(\"Image \" + url + \" has not been loaded\");\n            }\n            if (img === \"ERROR\") {\n                return null;\n            }\n            img = this.IMAGES[url] = this.attach(img.asStream(this));\n        }\n        return img;\n    }\n\n    getOpacityGS(opacity, forStroke) {\n        var id = parseFloat(opacity).toFixed(3);\n        opacity = parseFloat(id);\n        id += forStroke ? \"S\" : \"F\";\n        var cache = this._opacityGSCache || (this._opacityGSCache = {});\n        var gs = cache[id];\n        if (!gs) {\n            var props = {\n                Type: _(\"ExtGState\")\n            };\n            if (forStroke) {\n                props.CA = opacity;\n            } else {\n                props.ca = opacity;\n            }\n            gs = this.attach(new PDFDictionary(props));\n            gs._resourceName = _(\"GS\" + (++RESOURCE_COUNTER));\n            cache[id] = gs;\n        }\n        return gs;\n    }\n\n    dict(props) {\n        return new PDFDictionary(props);\n    }\n\n    name(str) {\n        return _(str);\n    }\n\n    stream(props, content) {\n        return new PDFStream(content, props);\n    }\n}\n\n/* -----[ utils ]----- */\n\nfunction pad(str, len, ch) {\n    while (str.length < len) {\n        str = ch + str;\n    }\n    return str;\n}\n\nfunction zeropad(n, len) {\n    return pad(String(n), len, \"0\");\n}\n\nfunction hasOwnProperty(obj, key) {\n    return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nvar isArray = Array.isArray || function(obj) {\n    return obj instanceof Array;\n};\n\nfunction isDate(obj) {\n    return obj instanceof Date;\n}\n\nfunction renderArray(a, out) {\n    out(\"[\");\n    if (a.length > 0) {\n        out.withIndent(function(){\n            for (var i = 0; i < a.length; ++i) {\n                if (i > 0 && i % 8 === 0) {\n                    out.indent(a[i]);\n                } else {\n                    out(\" \", a[i]);\n                }\n            }\n        });\n        //out.indent();\n    }\n    out(\" ]\");\n}\n\nfunction renderDate(date, out) {\n    out(\"(D:\",\n        zeropad(date.getUTCFullYear(), 4),\n        zeropad(date.getUTCMonth() + 1, 2),\n        zeropad(date.getUTCDate(), 2),\n        zeropad(date.getUTCHours(), 2),\n        zeropad(date.getUTCMinutes(), 2),\n        zeropad(date.getUTCSeconds(), 2),\n        \"Z)\");\n}\n\nfunction mm2pt(mm) {\n    return mm * (72/25.4);\n}\n\nfunction cm2pt(cm) {\n    return mm2pt(cm * 10);\n}\n\nfunction in2pt(inch)  {\n    return inch * 72;\n}\n\n\nfunction unitsToPoints(x, def) {\n    if (typeof x == \"number\") {\n        return x;\n    }\n    if (typeof x == \"string\") {\n        var m;\n        m = /^\\s*([0-9.]+)\\s*(mm|cm|in|pt)\\s*$/.exec(x);\n        if (m) {\n            var num = parseFloat(m[1]);\n            if (!isNaN(num)) {\n                if (m[2] == \"pt\") {\n                    return num;\n                }\n                return {\n                    \"mm\": mm2pt,\n                    \"cm\": cm2pt,\n                    \"in\": in2pt\n                }[m[2]](num);\n            }\n        }\n    }\n    if (def != null) {\n        return def;\n    }\n    throw new Error(\"Can't parse unit: \" + x);\n}\n\n/* -----[ PDF basic objects ]----- */\n\nclass PDFValue {\n    beforeRender() {}\n}\n\nclass PDFString extends PDFValue {\n    constructor(value, utf16be) {\n        super();\n        this.value = value;\n        this.utf16be = Boolean(utf16be);\n    }\n\n    render(out) {\n        let txt = this.value;\n        if (this.utf16be) {\n            txt = BOM + encodeUTF16BE(txt);\n            txt = txt.replace(/([\\(\\)\\\\])/g, \"\\\\$1\");\n            out(\"(\", txt, \")\");\n        } else {\n            // out.writeString truncates charcodes to 8 bits and\n            // 0x128 & 0xFF is 40, the code for open paren.\n            // therefore we need to do the chopping here to make\n            // sure we backslash all cases.\n            let data = [ 40 ]; // open PDF string '('\n            for (var i = 0; i < txt.length; ++i) {\n                let code = txt.charCodeAt(i) & 0xFF;\n                if (code == 40 || code == 41 || code == 92) {\n                    // backslash before (, ) and \\\n                    data.push(92);\n                }\n                data.push(code);\n            }\n            data.push(41);  // ')' close PDF string\n            out.writeData(data);\n        }\n    }\n\n    toString() {\n        return this.value;\n    }\n}\n\nclass PDFHexString extends PDFString {\n    constructor(value) {\n        super(value);\n        this.value = value;\n    }\n\n    render(out) {\n        out(\"<\");\n        for (var i = 0; i < this.value.length; ++i) {\n            out(zeropad(this.value.charCodeAt(i).toString(16), 4));\n        }\n        out(\">\");\n    }\n}\n\n/// names\nclass PDFName extends PDFValue {\n    static get(name) {\n        return _(name);\n    }\n\n    constructor(name) {\n        super();\n        this.name = name;\n    }\n\n    render(out) {\n        out(\"/\" + this.escape());\n    }\n\n    escape() {\n        return this.name.replace(/[^\\x21-\\x7E]/g, function(c){\n            return \"#\" + zeropad(c.charCodeAt(0).toString(16), 2);\n        });\n    }\n\n    toString() {\n        return this.name;\n    }\n}\n\nvar PDFName_cache = {};\n\nfunction _(name) {\n    if (hasOwnProperty(PDFName_cache, name)) {\n        return PDFName_cache[name];\n    }\n    return (PDFName_cache[name] = new PDFName(name));\n}\n\n/// dictionary\n\nclass PDFDictionary extends PDFValue {\n    constructor(props) {\n        super();\n        this.props = props;\n    }\n\n    render(out) {\n        var props = this.props, empty = true;\n        out(\"<<\");\n        out.withIndent(function(){\n            for (var i in props) {\n                if (hasOwnProperty(props, i) && !/^_/.test(i)) {\n                    empty = false;\n                    out.indent(_(i), \" \", props[i]);\n                }\n            }\n        });\n        if (!empty) {\n            out.indent();\n        }\n        out(\">>\");\n    }\n}\n\n/// streams\n\nclass PDFStream extends PDFValue {\n    constructor(data, props, compress) {\n        super();\n        if (typeof data == \"string\") {\n            var tmp = BinaryStream();\n            tmp.write(data);\n            data = tmp;\n        }\n        this.data = data;\n        this.props = props || {};\n        this.compress = compress;\n    }\n\n    render(out) {\n        var data = this.data.get(), props = this.props;\n        if (this.compress && supportsDeflate()) {\n            if (!props.Filter) {\n                props.Filter = [];\n            } else if (!(props.Filter instanceof Array)) {\n                props.Filter = [ props.Filter ];\n            }\n            props.Filter.unshift(_(\"FlateDecode\"));\n            data = deflate(data);\n        }\n        props.Length = data.length;\n        out(new PDFDictionary(props), \" stream\", NL);\n        out.writeData(data);\n        out(NL, \"endstream\");\n    }\n}\n\n/// catalog\n\nclass PDFCatalog extends PDFDictionary {\n    constructor() {\n        super({\n            Type: _(\"Catalog\")\n        });\n    }\n\n    setPages(pagesObj) {\n        this.props.Pages = pagesObj;\n    }\n}\n\n/// page tree\n\nclass PDFPageTree extends PDFDictionary {\n    constructor() {\n        super({\n            Type  : _(\"Pages\"),\n            Kids  : [],\n            Count : 0\n        });\n    }\n\n    addPage(pageObj) {\n        this.props.Kids.push(pageObj);\n        this.props.Count++;\n    }\n}\n\n/// images\n\n// JPEG\n\nvar SOF_CODES = [0xc0, 0xc1, 0xc2, 0xc3, 0xc5, 0xc6, 0xc7, 0xc9, 0xca, 0xcb, 0xcd, 0xce, 0xcf];\n\nclass PDFJpegImage {\n    constructor(data) {\n        // we must determine the correct color space.  we'll parse a bit\n        // of the JPEG stream for this, it's still better than going\n        // through the canvas.\n        // https://github.com/telerik/kendo-ui-core/issues/2845\n        data.offset(0);\n        var width, height, colorSpace, bitsPerComponent;\n        var soi = data.readShort();\n        if (soi != 0xFFD8) {\n            // XXX: do we have some better options here?\n            throw new Error(\"Invalid JPEG image\");\n        }\n        while (!data.eof()) {\n            var ff = data.readByte();\n            if (ff != 0xFF) {\n                throw new Error(\"Invalid JPEG image\");\n            }\n            var marker = data.readByte();\n            var length = data.readShort();\n            if (SOF_CODES.indexOf(marker) >= 0) {\n                // \"start of frame\" marker\n                bitsPerComponent = data.readByte();\n                height = data.readShort();\n                width = data.readShort();\n                colorSpace = data.readByte();\n                break;\n            }\n            data.skip(length - 2);\n        }\n\n        if (colorSpace == null) {\n            throw new Error(\"Invalid JPEG image\");\n        }\n\n        var props = {\n            Type             : _(\"XObject\"),\n            Subtype          : _(\"Image\"),\n            Width            : width,\n            Height           : height,\n            BitsPerComponent : bitsPerComponent,\n            Filter           : _(\"DCTDecode\")\n        };\n\n        switch (colorSpace) {\n        case 1:\n            props.ColorSpace = _(\"DeviceGray\");\n            break;\n        case 3:\n            props.ColorSpace = _(\"DeviceRGB\");\n            break;\n        case 4:\n            props.ColorSpace = _(\"DeviceCMYK\");\n            props.Decode = [ 1, 0, 1, 0, 1, 0, 1, 0 ]; // invert colors\n            break;\n        }\n\n        this.asStream = function() {\n            data.offset(0);\n            var stream = new PDFStream(data, props);\n            stream._resourceName = _(\"I\" + (++RESOURCE_COUNTER));\n            return stream;\n        };\n    }\n}\n\n// PDFRawImage will be used for images with transparency (PNG)\n\nclass PDFRawImage {\n    constructor(width, height, rgb, alpha) {\n        this.asStream = function(pdf) {\n            var mask = new PDFStream(alpha, {\n                Type             : _(\"XObject\"),\n                Subtype          : _(\"Image\"),\n                Width            : width,\n                Height           : height,\n                BitsPerComponent : 8,\n                ColorSpace       : _(\"DeviceGray\")\n            }, true);\n            var stream = new PDFStream(rgb, {\n                Type             : _(\"XObject\"),\n                Subtype          : _(\"Image\"),\n                Width            : width,\n                Height           : height,\n                BitsPerComponent : 8,\n                ColorSpace       : _(\"DeviceRGB\"),\n                SMask            : pdf.attach(mask)\n            }, true);\n            stream._resourceName = _(\"I\" + (++RESOURCE_COUNTER));\n            return stream;\n        };\n    }\n}\n\n/// standard fonts\n\nclass PDFStandardFont extends PDFDictionary {\n    constructor(name){\n        super({\n            Type     : _(\"Font\"),\n            Subtype  : _(\"Type1\"),\n            BaseFont : _(name)\n        });\n\n        this._resourceName = _(\"F\" + (++RESOURCE_COUNTER));\n    }\n\n    encodeText(str) {\n        return new PDFString(String(str));\n    }\n}\n\n/// TTF fonts\n\nclass PDFFont extends PDFDictionary {\n    constructor(pdf, font, props){\n        super({});\n\n        props = this.props;\n        props.Type = _(\"Font\");\n        props.Subtype = _(\"Type0\");\n        props.Encoding = _(\"Identity-H\");\n\n        this._pdf = pdf;\n        this._font = font;\n        this._sub = font.makeSubset();\n        this._resourceName = _(\"F\" + (++RESOURCE_COUNTER));\n\n        var head = font.head;\n\n        this.name = font.psName;\n        var scale = this.scale = font.scale;\n        this.bbox = [\n            head.xMin * scale,\n            head.yMin * scale,\n            head.xMax * scale,\n            head.yMax * scale\n        ];\n\n        this.italicAngle = font.post.italicAngle;\n        this.ascent = font.ascent * scale;\n        this.descent = font.descent * scale;\n        this.lineGap = font.lineGap * scale;\n        this.capHeight = font.os2.capHeight || this.ascent;\n        this.xHeight = font.os2.xHeight || 0;\n        this.stemV = 0;\n\n        this.familyClass = (font.os2.familyClass || 0) >> 8;\n        this.isSerif = this.familyClass >= 1 && this.familyClass <= 7;\n        this.isScript = this.familyClass == 10;\n\n        this.flags = ((font.post.isFixedPitch ? 1 : 0) |\n                    (this.isSerif ? 1 << 1 : 0) |\n                    (this.isScript ? 1 << 3 : 0) |\n                    (this.italicAngle !== 0 ? 1 << 6 : 0) |\n                    (1 << 5));\n        }\n\n        encodeText(text) {\n            return new PDFHexString(this._sub.encodeText(String(text)));\n        }\n\n        getTextWidth(fontSize, text) {\n            var width = 0, codeMap = this._font.cmap.codeMap;\n            for (var i = 0; i < text.length; ++i) {\n                var glyphId = codeMap[text.charCodeAt(i)];\n                width += this._font.widthOfGlyph(glyphId || 0);\n            }\n            return width * fontSize / 1000;\n        }\n\n        beforeRender() {\n            var self = this;\n            var sub = self._sub;\n\n            // write the TTF data\n            var data = sub.render();\n            var fontStream = new PDFStream(BinaryStream(data), {\n                Length1: data.length\n            }, true);\n\n            var descriptor = self._pdf.attach(new PDFDictionary({\n                Type         : _(\"FontDescriptor\"),\n                FontName     : _(self._sub.psName),\n                FontBBox     : self.bbox,\n                Flags        : self.flags,\n                StemV        : self.stemV,\n                ItalicAngle  : self.italicAngle,\n                Ascent       : self.ascent,\n                Descent      : self.descent,\n                CapHeight    : self.capHeight,\n                XHeight      : self.xHeight,\n                FontFile2    : self._pdf.attach(fontStream)\n            }));\n\n            var cmap = sub.ncid2ogid;\n            var firstChar = sub.firstChar;\n            var lastChar = sub.lastChar;\n            var charWidths = [];\n            (function loop(i, chunk){\n                if (i <= lastChar) {\n                    var gid = cmap[i];\n                    if (gid == null) {\n                        loop(i + 1);\n                    } else {\n                        if (!chunk) {\n                            charWidths.push(i, chunk = []);\n                        }\n                        chunk.push(self._font.widthOfGlyph(gid));\n                        loop(i + 1, chunk);\n                    }\n                }\n            })(firstChar);\n\n            // As if two dictionaries weren't enough, we need another\n            // one, the \"descendant font\".  Only that one can be of\n            // Subtype CIDFontType2.  PDF is the X11 of document\n            // formats: portable but full of legacy that nobody cares\n            // about anymore.\n\n            var descendant = new PDFDictionary({\n                Type: _(\"Font\"),\n                Subtype: _(\"CIDFontType2\"),\n                BaseFont: _(self._sub.psName),\n                CIDSystemInfo: new PDFDictionary({\n                    Registry   : new PDFString(\"Adobe\"),\n                    Ordering   : new PDFString(\"Identity\"),\n                    Supplement : 0\n                }),\n                FontDescriptor: descriptor,\n                FirstChar: firstChar,\n                LastChar: lastChar,\n                DW: Math.round(self._font.widthOfGlyph(0)),\n                W: charWidths,\n                CIDToGIDMap: self._pdf.attach(self._makeCidToGidMap())\n            });\n\n            var dict = self.props;\n            dict.BaseFont = _(self._sub.psName);\n            dict.DescendantFonts = [ self._pdf.attach(descendant) ];\n\n            // Compute the ToUnicode map so that apps can extract\n            // meaningful text from the PDF.\n            var unimap = new PDFToUnicodeCmap(firstChar, lastChar, sub.subset);\n            var unimapStream = new PDFStream(makeOutput(), null, true);\n            unimapStream.data(unimap);\n            dict.ToUnicode = self._pdf.attach(unimapStream);\n        }\n\n        _makeCidToGidMap() {\n            return new PDFStream(BinaryStream(this._sub.cidToGidMap()), null, true);\n        }\n}\n\nclass PDFToUnicodeCmap extends PDFValue {\n    constructor(firstChar, lastChar, map){\n        super();\n        this.firstChar = firstChar;\n        this.lastChar = lastChar;\n        this.map = map;\n    }\n\n    render(out) {\n        out.indent(\"/CIDInit /ProcSet findresource begin\");\n        out.indent(\"12 dict begin\");\n        out.indent(\"begincmap\");\n        out.indent(\"/CIDSystemInfo <<\");\n        out.indent(\"  /Registry (Adobe)\");\n        out.indent(\"  /Ordering (UCS)\");\n        out.indent(\"  /Supplement 0\");\n        out.indent(\">> def\");\n        out.indent(\"/CMapName /Adobe-Identity-UCS def\");\n        out.indent(\"/CMapType 2 def\");\n        out.indent(\"1 begincodespacerange\");\n        out.indent(\"  <0000><ffff>\");\n        out.indent(\"endcodespacerange\");\n\n        var self = this;\n        out.indent(self.lastChar - self.firstChar + 1, \" beginbfchar\");\n        out.withIndent(function(){\n            for (var code = self.firstChar; code <= self.lastChar; ++code) {\n                var unicode = self.map[code];\n                var str = ucs2encode([ unicode ]);\n                out.indent(\"<\", zeropad(code.toString(16), 4), \">\", \"<\");\n                for (var i = 0; i < str.length; ++i) {\n                    out(zeropad(str.charCodeAt(i).toString(16), 4));\n                }\n                out(\">\");\n            }\n        });\n        out.indent(\"endbfchar\");\n\n        out.indent(\"endcmap\");\n        out.indent(\"CMapName currentdict /CMap defineresource pop\");\n        out.indent(\"end\");\n        out.indent(\"end\");\n    }\n}\n\n/// gradients\n\nfunction makeHash(a) {\n    return a.map(function(x){\n        return isArray(x) ? makeHash(x)\n            : typeof x == \"number\" ? (Math.round(x * 1000) / 1000).toFixed(3)\n            : x;\n    }).join(\" \");\n}\n\nfunction cacheColorGradientFunction(pdf, r1, g1, b1, r2, g2, b2) {\n    var hash = makeHash([ r1, g1, b1, r2, g2, b2 ]);\n    var func = pdf.GRAD_COL_FUNCTIONS[hash];\n    if (!func) {\n        func = pdf.GRAD_COL_FUNCTIONS[hash] = pdf.attach(new PDFDictionary({\n            FunctionType: 2,\n            Domain: [ 0, 1 ],\n            Range: [ 0, 1, 0, 1, 0, 1 ],\n            N: 1,\n            C0: [ r1 , g1 , b1 ],\n            C1: [ r2 , g2 , b2 ]\n        }));\n    }\n    return func;\n}\n\nfunction cacheOpacityGradientFunction(pdf, a1, a2) {\n    var hash = makeHash([ a1, a2 ]);\n    var func = pdf.GRAD_OPC_FUNCTIONS[hash];\n    if (!func) {\n        func = pdf.GRAD_OPC_FUNCTIONS[hash] = pdf.attach(new PDFDictionary({\n            FunctionType: 2,\n            Domain: [ 0, 1 ],\n            Range: [ 0, 1 ],\n            N: 1,\n            C0: [ a1 ],\n            C1: [ a2 ]\n        }));\n    }\n    return func;\n}\n\nfunction makeGradientFunctions(pdf, stops) {\n    var hasAlpha = false;\n    var opacities = [];\n    var colors = [];\n    var offsets = [];\n    var encode = [];\n    var i, prev, cur, prevColor, curColor;\n    for (i = 1; i < stops.length; ++i) {\n        prev = stops[i - 1];\n        cur = stops[i];\n        prevColor = prev.color;\n        curColor = cur.color;\n        colors.push(cacheColorGradientFunction(\n            pdf,\n            prevColor.r, prevColor.g, prevColor.b,\n            curColor.r,  curColor.g,  curColor.b\n        ));\n        if (prevColor.a < 1 || curColor.a < 1) {\n            hasAlpha = true;\n        }\n        offsets.push(cur.offset);\n        encode.push(0, 1);\n    }\n    if (hasAlpha) {\n        for (i = 1; i < stops.length; ++i) {\n            prev = stops[i - 1];\n            cur = stops[i];\n            prevColor = prev.color;\n            curColor = cur.color;\n            opacities.push(cacheOpacityGradientFunction(\n                pdf, prevColor.a, curColor.a\n            ));\n        }\n    }\n    offsets.pop();\n    return {\n        hasAlpha  : hasAlpha,\n        colors    : assemble(colors),\n        opacities : hasAlpha ? assemble(opacities) : null\n    };\n    function assemble(funcs) {\n        if (funcs.length == 1) {\n            return funcs[0];\n        }\n        return {\n            FunctionType: 3,\n            Functions: funcs,\n            Domain: [ 0, 1 ],\n            Bounds: offsets,\n            Encode: encode\n        };\n    }\n}\n\nfunction cacheColorGradient(pdf, isRadial, stops, coords, funcs, box) {\n    var shading, hash;\n    // if box is given then we have user-space coordinates, which\n    // means the gradient is designed for a certain position/size\n    // on page.  caching won't do any good.\n    if (!box) {\n        var a = [ isRadial ].concat(coords);\n        stops.forEach(function(x){\n            a.push(x.offset, x.color.r, x.color.g, x.color.b);\n        });\n        hash = makeHash(a);\n        shading = pdf.GRAD_COL[hash];\n    }\n    if (!shading) {\n        shading = new PDFDictionary({\n            Type: _(\"Shading\"),\n            ShadingType: isRadial ? 3 : 2,\n            ColorSpace: _(\"DeviceRGB\"),\n            Coords: coords,\n            Domain: [ 0, 1 ],\n            Function: funcs,\n            Extend: [ true, true ]\n        });\n        pdf.attach(shading);\n        shading._resourceName = \"S\" + (++RESOURCE_COUNTER);\n        if (hash) {\n            pdf.GRAD_COL[hash] = shading;\n        }\n    }\n    return shading;\n}\n\nfunction cacheOpacityGradient(pdf, isRadial, stops, coords, funcs, box) {\n    var opacity, hash;\n    // if box is given then we have user-space coordinates, which\n    // means the gradient is designed for a certain position/size\n    // on page.  caching won't do any good.\n    if (!box) {\n        var a = [ isRadial ].concat(coords);\n        stops.forEach(function(x){\n            a.push(x.offset, x.color.a);\n        });\n        hash = makeHash(a);\n        opacity = pdf.GRAD_OPC[hash];\n    }\n    if (!opacity) {\n        opacity = new PDFDictionary({\n            Type: _(\"ExtGState\"),\n            AIS: false,\n            CA: 1,\n            ca: 1,\n            SMask: {\n                Type: _(\"Mask\"),\n                S: _(\"Luminosity\"),\n                G: pdf.attach(new PDFStream(\"/a0 gs /s0 sh\", {\n                    Type: _(\"XObject\"),\n                    Subtype: _(\"Form\"),\n                    FormType: 1,\n                    BBox: (box ? [\n                        box.left, box.top + box.height, box.left + box.width, box.top\n                    ] : [ 0, 1, 1, 0 ]),\n                    Group: {\n                        Type: _(\"Group\"),\n                        S: _(\"Transparency\"),\n                        CS: _(\"DeviceGray\"),\n                        I: true\n                    },\n                    Resources: {\n                        ExtGState: {\n                            a0: { CA: 1, ca: 1 }\n                        },\n                        Shading: {\n                            s0: {\n                                ColorSpace: _(\"DeviceGray\"),\n                                Coords: coords,\n                                Domain: [ 0, 1 ],\n                                ShadingType: isRadial ? 3 : 2,\n                                Function: funcs,\n                                Extend: [ true, true ]\n                            }\n                        }\n                    }\n                }))\n            }\n        });\n        pdf.attach(opacity);\n        opacity._resourceName = \"O\" + (++RESOURCE_COUNTER);\n        if (hash) {\n            pdf.GRAD_OPC[hash] = opacity;\n        }\n    }\n    return opacity;\n}\n\nfunction cacheGradient(pdf, gradient, box) {\n    var isRadial = gradient.type == \"radial\";\n    var funcs = makeGradientFunctions(pdf, gradient.stops);\n    var coords = isRadial ? [\n        gradient.start.x , gradient.start.y , gradient.start.r,\n        gradient.end.x   , gradient.end.y   , gradient.end.r\n    ] : [\n        gradient.start.x , gradient.start.y,\n        gradient.end.x   , gradient.end.y\n    ];\n    var shading = cacheColorGradient(\n        pdf, isRadial, gradient.stops, coords, funcs.colors, gradient.userSpace && box\n    );\n    var opacity = funcs.hasAlpha ? cacheOpacityGradient(\n        pdf, isRadial, gradient.stops, coords, funcs.opacities, gradient.userSpace && box\n    ) : null;\n    return {\n        hasAlpha: funcs.hasAlpha,\n        shading: shading,\n        opacity: opacity\n    };\n}\n\n/// page object\n\nclass PDFPage extends PDFDictionary {\n    constructor(pdf, props){\n        super(props);\n\n        this._pdf = pdf;\n        this._rcount = 0;\n        this._textMode = false;\n        this._fontResources = {};\n        this._gsResources = {};\n        this._xResources = {};\n        this._patResources = {};\n        this._shResources = {};\n        this._opacity = 1;\n        this._matrix = [ 1, 0, 0, 1, 0, 0 ];\n        this._annotations = [];\n\n        this._font = null;\n        this._fontSize = null;\n\n        this._contextStack = [];\n\n        props = this.props;\n        props.Type = _(\"Page\");\n        props.ProcSet = [\n            _(\"PDF\"),\n            _(\"Text\"),\n            _(\"ImageB\"),\n            _(\"ImageC\"),\n            _(\"ImageI\")\n        ];\n        props.Resources = new PDFDictionary({\n            Font      : new PDFDictionary(this._fontResources),\n            ExtGState : new PDFDictionary(this._gsResources),\n            XObject   : new PDFDictionary(this._xResources),\n            Pattern   : new PDFDictionary(this._patResources),\n            Shading   : new PDFDictionary(this._shResources)\n        });\n        props.Annots = this._annotations;\n    }\n\n    _out() {\n        this._content.data.apply(null, arguments);\n    }\n\n    transform(a, b, c, d, e, f) {\n        if (!isIdentityMatrix(arguments)) {\n            this._matrix = mmul(arguments, this._matrix);\n            this._out(a, \" \", b, \" \", c, \" \", d, \" \", e, \" \", f, \" cm\");\n            // XXX: debug\n            // this._out(\" % current matrix: \", this._matrix);\n            this._out(NL);\n        }\n    }\n\n    translate(dx, dy) {\n        this.transform(1, 0, 0, 1, dx, dy);\n    }\n\n    scale(sx, sy) {\n        this.transform(sx, 0, 0, sy, 0, 0);\n    }\n\n    rotate(angle) {\n        var cos = Math.cos(angle), sin = Math.sin(angle);\n        this.transform(cos, sin, -sin, cos, 0, 0);\n    }\n\n    beginText() {\n        this._textMode = true;\n        this._out(\"BT\", NL);\n    }\n\n    endText() {\n        this._textMode = false;\n        this._out(\"ET\", NL);\n    }\n\n    _requireTextMode() {\n        if (!this._textMode) {\n            throw new Error(\"Text mode required; call page.beginText() first\");\n        }\n    }\n\n    _requireFont() {\n        if (!this._font) {\n            throw new Error(\"No font selected; call page.setFont() first\");\n        }\n    }\n\n    setFont(font, size) {\n        this._requireTextMode();\n        if (font == null) {\n            font = this._font;\n        } else if (!(font instanceof PDFFont)) {\n            font = this._pdf.getFont(font);\n        }\n        if (size == null) {\n            size = this._fontSize;\n        }\n        this._fontResources[font._resourceName] = font;\n        this._font = font;\n        this._fontSize = size;\n        this._out(font._resourceName, \" \", size, \" Tf\", NL);\n    }\n\n    setTextLeading(size) {\n        this._requireTextMode();\n        this._out(size, \" TL\", NL);\n    }\n\n    setTextRenderingMode(mode) {\n        this._requireTextMode();\n        this._out(mode, \" Tr\", NL);\n    }\n\n    showText(text, requestedWidth) {\n        this._requireFont();\n        if (text.length > 1 && requestedWidth && this._font instanceof PDFFont) {\n            var outputWidth = this._font.getTextWidth(this._fontSize, text);\n            var scale = requestedWidth / outputWidth * 100;\n            this._out(scale, \" Tz \");\n        }\n        this._out(this._font.encodeText(text), \" Tj\", NL);\n    }\n\n    showTextNL(text) {\n        this._requireFont();\n        this._out(this._font.encodeText(text), \" '\", NL);\n    }\n\n    addLink(uri, box) {\n        var ll = this._toPage({ x: box.left, y: box.bottom });\n        var ur = this._toPage({ x: box.right, y: box.top });\n        this._annotations.push(new PDFDictionary({\n            Type    : _(\"Annot\"),\n            Subtype : _(\"Link\"),\n            Rect    : [ ll.x, ll.y, ur.x, ur.y ],\n            Border  : [ 0, 0, 0 ],\n            A       : new PDFDictionary({\n                Type : _(\"Action\"),\n                S    : _(\"URI\"),\n                URI  : new PDFString(uri)\n            })\n        }));\n    }\n\n    setStrokeColor(r, g, b) {\n        this._out(r, \" \", g, \" \", b, \" RG\", NL);\n    }\n\n    setOpacity(opacity) {\n        this.setFillOpacity(opacity);\n        this.setStrokeOpacity(opacity);\n        this._opacity *= opacity;\n    }\n\n    setStrokeOpacity(opacity) {\n        if (opacity < 1) {\n            var gs = this._pdf.getOpacityGS(this._opacity * opacity, true);\n            this._gsResources[gs._resourceName] = gs;\n            this._out(gs._resourceName, \" gs\", NL);\n        }\n    }\n\n    setFillColor(r, g, b) {\n        this._out(r, \" \", g, \" \", b, \" rg\", NL);\n    }\n\n    setFillOpacity(opacity) {\n        if (opacity < 1) {\n            var gs = this._pdf.getOpacityGS(this._opacity * opacity, false);\n            this._gsResources[gs._resourceName] = gs;\n            this._out(gs._resourceName, \" gs\", NL);\n        }\n    }\n\n    gradient(gradient, box) {\n        this.save();\n        this.rect(box.left, box.top, box.width, box.height);\n        this.clip();\n        if (!gradient.userSpace) {\n            this.transform(box.width, 0, 0, box.height, box.left, box.top);\n        }\n        var g = cacheGradient(this._pdf, gradient, box);\n        var sname = g.shading._resourceName, oname;\n        this._shResources[sname] = g.shading;\n        if (g.hasAlpha) {\n            oname = g.opacity._resourceName;\n            this._gsResources[oname] = g.opacity;\n            this._out(\"/\" + oname + \" gs \");\n        }\n        this._out(\"/\" + sname + \" sh\", NL);\n        this.restore();\n    }\n\n    setDashPattern(dashArray, dashPhase) {\n        this._out(dashArray, \" \", dashPhase, \" d\", NL);\n    }\n\n    setLineWidth(width) {\n        this._out(width, \" w\", NL);\n    }\n\n    setLineCap(lineCap) {\n        this._out(lineCap, \" J\", NL);\n    }\n\n    setLineJoin(lineJoin) {\n        this._out(lineJoin, \" j\", NL);\n    }\n\n    setMitterLimit(mitterLimit) {\n        this._out(mitterLimit, \" M\", NL);\n    }\n\n    save() {\n        this._contextStack.push(this._context());\n        this._out(\"q\", NL);\n    }\n\n    restore() {\n        this._out(\"Q\", NL);\n        this._context(this._contextStack.pop());\n    }\n\n\n    // paths\n    moveTo(x, y) {\n        this._out(x, \" \", y, \" m\", NL);\n    }\n\n    lineTo(x, y) {\n        this._out(x, \" \", y, \" l\", NL);\n    }\n\n    bezier(x1, y1, x2, y2, x3, y3) {\n        this._out(x1, \" \", y1, \" \", x2, \" \", y2, \" \", x3, \" \", y3, \" c\", NL);\n    }\n\n    bezier1(x1, y1, x3, y3) {\n        this._out(x1, \" \", y1, \" \", x3, \" \", y3, \" y\", NL);\n    }\n\n    bezier2(x2, y2, x3, y3) {\n        this._out(x2, \" \", y2, \" \", x3, \" \", y3, \" v\", NL);\n    }\n\n    close() {\n        this._out(\"h\", NL);\n    }\n\n    rect(x, y, w, h) {\n        this._out(x, \" \", y, \" \", w, \" \", h, \" re\", NL);\n    }\n\n    ellipse(x, y, rx, ry) {\n        function _X(v) { return x + v; }\n        function _Y(v) { return y + v; }\n\n        // how to get to the \"magic number\" is explained here:\n        // http://www.whizkidtech.redprince.net/bezier/circle/kappa/\n        var k = 0.5522847498307936;\n\n        this.moveTo(_X(0), _Y(ry));\n        this.bezier(\n            _X(rx * k) , _Y(ry),\n            _X(rx)     , _Y(ry * k),\n            _X(rx)     , _Y(0)\n        );\n        this.bezier(\n            _X(rx)     , _Y(-ry * k),\n            _X(rx * k) , _Y(-ry),\n            _X(0)      , _Y(-ry)\n        );\n        this.bezier(\n            _X(-rx * k) , _Y(-ry),\n            _X(-rx)     , _Y(-ry * k),\n            _X(-rx)     , _Y(0)\n        );\n        this.bezier(\n            _X(-rx)     , _Y(ry * k),\n            _X(-rx * k) , _Y(ry),\n            _X(0)       , _Y(ry)\n        );\n    }\n\n    circle(x, y, r) {\n        this.ellipse(x, y, r, r);\n    }\n\n    stroke() {\n        this._out(\"S\", NL);\n    }\n\n    nop() {\n        this._out(\"n\", NL);\n    }\n\n    clip() {\n        this._out(\"W n\", NL);\n    }\n\n    clipStroke() {\n        this._out(\"W S\", NL);\n    }\n\n    closeStroke() {\n        this._out(\"s\", NL);\n    }\n\n    fill() {\n        this._out(\"f\", NL);\n    }\n\n    fillStroke() {\n        this._out(\"B\", NL);\n    }\n\n    drawImage(url) {\n        var img = this._pdf.getImage(url);\n        if (img) { // the result can be null for a cross-domain image\n            this._xResources[img._resourceName] = img;\n            this._out(img._resourceName, \" Do\", NL);\n        }\n    }\n\n    comment(txt) {\n        var self = this;\n        txt.split(/\\r?\\n/g).forEach(function(line){\n            self._out(\"% \", line, NL);\n        });\n    }\n\n    // internal\n    _context(val) {\n        if (val != null) {\n            this._opacity = val.opacity;\n            this._matrix = val.matrix;\n        } else {\n            return {\n                opacity: this._opacity,\n                matrix: this._matrix\n            };\n        }\n    }\n\n    _toPage(p) {\n        var m = this._matrix;\n        var a = m[0], b = m[1], c = m[2], d = m[3], e = m[4], f = m[5];\n        return {\n            x: a*p.x + c*p.y + e,\n            y: b*p.x + d*p.y + f\n        };\n    }\n}\n\nfunction unquote(str) {\n    return str.replace(/^\\s*(['\"])(.*)\\1\\s*$/, \"$2\");\n}\n\nfunction parseFontDef(fontdef) {\n    // XXX: this is very crude for now and buggy.  Proper parsing is quite involved.\n    var rx = /^\\s*((normal|italic)\\s+)?((normal|small-caps)\\s+)?((normal|bold|\\d+)\\s+)?(([0-9.]+)(px|pt))(\\/(([0-9.]+)(px|pt)|normal))?\\s+(.*?)\\s*$/i;\n    var m = rx.exec(fontdef);\n    if (!m) {\n        return { fontSize: 12, fontFamily: \"sans-serif\" };\n    }\n    var fontSize = m[8] ? parseInt(m[8], 10) : 12;\n    return {\n        italic     : m[2] && m[2].toLowerCase() == \"italic\",\n        variant    : m[4],\n        bold       : m[6] && /bold|700/i.test(m[6]),\n        fontSize   : fontSize,\n        lineHeight : m[12] ? m[12] == \"normal\" ? fontSize : parseInt(m[12], 10) : null,\n        fontFamily : m[14].split(/\\s*,\\s*/g).map(unquote)\n    };\n}\n\nfunction getFontURL(style) {\n    function mkFamily(name) {\n        if (style.bold) {\n            name += \"|bold\";\n        }\n        if (style.italic) {\n            name += \"|italic\";\n        }\n        return name.toLowerCase();\n    }\n    var fontFamily = style.fontFamily;\n    var name, url;\n    if (fontFamily instanceof Array) {\n        for (var i = 0; i < fontFamily.length; ++i) {\n            name = mkFamily(fontFamily[i]);\n            url = FONT_MAPPINGS[name];\n            if (url) {\n                break;\n            }\n        }\n    } else {\n        url = FONT_MAPPINGS[fontFamily.toLowerCase()];\n    }\n    while (typeof url == \"function\") {\n        url = url();\n    }\n    if (!url) {\n        url = \"Times-Roman\";\n    }\n    return url;\n}\n\nvar FONT_MAPPINGS = {\n    \"serif\"                    : \"Times-Roman\",\n    \"serif|bold\"               : \"Times-Bold\",\n    \"serif|italic\"             : \"Times-Italic\",\n    \"serif|bold|italic\"        : \"Times-BoldItalic\",\n    \"sans-serif\"               : \"Helvetica\",\n    \"sans-serif|bold\"          : \"Helvetica-Bold\",\n    \"sans-serif|italic\"        : \"Helvetica-Oblique\",\n    \"sans-serif|bold|italic\"   : \"Helvetica-BoldOblique\",\n    \"monospace\"                : \"Courier\",\n    \"monospace|bold\"           : \"Courier-Bold\",\n    \"monospace|italic\"         : \"Courier-Oblique\",\n    \"monospace|bold|italic\"    : \"Courier-BoldOblique\",\n    \"zapfdingbats\"             : \"ZapfDingbats\",\n    \"zapfdingbats|bold\"        : \"ZapfDingbats\",\n    \"zapfdingbats|italic\"      : \"ZapfDingbats\",\n    \"zapfdingbats|bold|italic\" : \"ZapfDingbats\"\n};\n\nfunction fontAlias(alias, name) {\n    alias = alias.toLowerCase();\n    FONT_MAPPINGS[alias] = function() {\n        return FONT_MAPPINGS[name];\n    };\n    FONT_MAPPINGS[alias + \"|bold\"] = function() {\n        return FONT_MAPPINGS[name + \"|bold\"];\n    };\n    FONT_MAPPINGS[alias + \"|italic\"] = function() {\n        return FONT_MAPPINGS[name + \"|italic\"];\n    };\n    FONT_MAPPINGS[alias + \"|bold|italic\"] = function() {\n        return FONT_MAPPINGS[name + \"|bold|italic\"];\n    };\n}\n\n// Let's define some common names to an appropriate replacement.\n// These are overridable via pdf.defineFont, should the user want to\n// include the proper versions.\n\nfontAlias(\"Times New Roman\" , \"serif\");\nfontAlias(\"Courier New\"     , \"monospace\");\nfontAlias(\"Arial\"           , \"sans-serif\");\nfontAlias(\"Helvetica\"       , \"sans-serif\");\nfontAlias(\"Verdana\"         , \"sans-serif\");\nfontAlias(\"Tahoma\"          , \"sans-serif\");\nfontAlias(\"Georgia\"         , \"sans-serif\");\nfontAlias(\"Monaco\"          , \"monospace\");\nfontAlias(\"Andale Mono\"     , \"monospace\");\n\nfunction defineFont(name, url) {\n    if (arguments.length == 1) {\n        for (var i in name) {\n            if (hasOwnProperty(name, i)) {\n                defineFont(i, name[i]);\n            }\n        }\n    } else {\n        name = name.toLowerCase();\n        FONT_MAPPINGS[name] = url;\n\n        // special handling for DejaVu fonts: if they get defined,\n        // let them also replace the default families, for good\n        // Unicode support out of the box.\n        switch (name) {\n          case \"dejavu sans\"               : FONT_MAPPINGS[\"sans-serif\"]              = url; break;\n          case \"dejavu sans|bold\"          : FONT_MAPPINGS[\"sans-serif|bold\"]         = url; break;\n          case \"dejavu sans|italic\"        : FONT_MAPPINGS[\"sans-serif|italic\"]       = url; break;\n          case \"dejavu sans|bold|italic\"   : FONT_MAPPINGS[\"sans-serif|bold|italic\"]  = url; break;\n          case \"dejavu serif\"              : FONT_MAPPINGS[\"serif\"]                   = url; break;\n          case \"dejavu serif|bold\"         : FONT_MAPPINGS[\"serif|bold\"]              = url; break;\n          case \"dejavu serif|italic\"       : FONT_MAPPINGS[\"serif|italic\"]            = url; break;\n          case \"dejavu serif|bold|italic\"  : FONT_MAPPINGS[\"serif|bold|italic\"]       = url; break;\n          case \"dejavu mono\"               : FONT_MAPPINGS[\"monospace\"]               = url; break;\n          case \"dejavu mono|bold\"          : FONT_MAPPINGS[\"monospace|bold\"]          = url; break;\n          case \"dejavu mono|italic\"        : FONT_MAPPINGS[\"monospace|italic\"]        = url; break;\n          case \"dejavu mono|bold|italic\"   : FONT_MAPPINGS[\"monospace|bold|italic\"]   = url; break;\n        }\n    }\n}\n\nfunction mmul(a, b) {\n    var a1 = a[0], b1 = a[1], c1 = a[2], d1 = a[3], e1 = a[4], f1 = a[5];\n    var a2 = b[0], b2 = b[1], c2 = b[2], d2 = b[3], e2 = b[4], f2 = b[5];\n    return [\n        a1*a2 + b1*c2,          a1*b2 + b1*d2,\n        c1*a2 + d1*c2,          c1*b2 + d1*d2,\n        e1*a2 + f1*c2 + e2,     e1*b2 + f1*d2 + f2\n    ];\n}\n\nfunction isIdentityMatrix(m) {\n    return m[0] === 1 && m[1] === 0 && m[2] === 0 && m[3] === 1 && m[4] === 0 && m[5] === 0;\n}\n\nconst TEXT_RENDERING_MODE = {\n    fill           : 0,\n    stroke         : 1,\n    fillAndStroke  : 2,\n    invisible      : 3,\n    fillAndClip    : 4,\n    strokeAndClip  : 5,\n    fillStrokeClip : 6,\n    clip           : 7\n};\n\nexport {\n    PDFDocument as Document,\n    BinaryStream,\n    defineFont,\n    parseFontDef,\n    getFontURL,\n    loadFonts,\n    loadImages,\n    getPaperOptions,\n    clearImageCache,\n    TEXT_RENDERING_MODE\n};\n"]},"metadata":{},"sourceType":"module"}